import{V as A,W as S,P as C,X as E,b,c as o,o as l,a as t,F as i,D as d,v as g,E as c,Y as P,Z as v,_ as T,$ as B,a0 as L,a1 as O,a2 as V,a3 as D,a4 as F,a5 as W,a6 as M,a7 as N,a8 as j}from"./index-DlZXj8Km.js";import{s as q}from"./index-DXmzaT4Q.js";const H={class:"my-2"},Q={class:"table table-sm table-bordered"},U={key:0},X=["href"],Y={class:"me-2"},Z=["href"],z={class:"table table-sm table-bordered"},G={key:0},I=["href"],J={class:"me-2"},K=["href"],R={class:"table table-sm table-bordered"},tt=["href"],et={class:"me-2"},st=["href"],rt={__name:"Crawler",setup(f){A(),S(),C(()=>{console.log("startCrawler")}),E(()=>{});const u=b({}),h=b({});function p(e){return new Promise(async(r,a)=>{try{const s=await fetch(e);if(!s.ok)return a({status:s.status,statusText:s.statusText,error:`HTTP ${s.status}`});const n=await s.text(),$=[...new DOMParser().parseFromString(n,"text/html").querySelectorAll("a")].map(x=>x.getAttribute("href")).filter(Boolean);r($)}catch(s){a({status:null,statusText:null,error:s.message})}})}async function k(e,r){await w(e,r);const a=Object.fromEntries(Object.entries(u.value).sort(([s],[n])=>s.localeCompare(n)));u.value=a,await y()}async function y(){for(let e in h.value)try{await p(e),h.value[e].status="done",h.value[e].check="ok"}catch(r){h.value[e].check=r.error}}async function w(e,r){if(["#","/a_dmin","/f_ilament"].some(n=>e.startsWith(n)))return;if(["//","http://","https://"].some(n=>e.startsWith(n))){e in h.value||(h.value[e]={status:"reading",check:"unknown",parentArr:[r]}),h.value[e].push(r);return}if(e in u.value){u.value[e].check!="ok"&&u.value[e].parentArr.push(r);return}u.value[e]={status:"reading",check:"unknown",parentArr:[r]};try{const n=await p(e);u.value[e].check="ok";for(const _ of n)await k(_,e)}catch(n){u.value[e].check=n.error}finally{u.value[e].status="done"}}return(e,r)=>(l(),o(i,null,[r[1]||(r[1]=t("h1",null,"Crawler 0.5",-1)),t("div",H,[t("button",{class:"btn btn-primary fas fa-angle-right",onClick:r[0]||(r[0]=a=>k("/",""))})]),r[2]||(r[2]=t("h3",null,"Error",-1)),t("table",Q,[t("tbody",null,[(l(!0),o(i,null,d(u.value,(a,s)=>(l(),o(i,{key:s},[a.check!="ok"?(l(),o("tr",U,[t("td",null,[t("a",{href:s,target:"_blank"},c(s),9,X)]),t("td",null,c(a.status),1),t("td",null,c(a.check),1),t("td",null,[(l(!0),o(i,null,d(a.parentArr,n=>(l(),o("span",Y,[t("a",{href:n,target:"_blank"},c(n),9,Z)]))),256))])])):g("",!0)],64))),128))])]),r[3]||(r[3]=t("h3",null,"Ok",-1)),t("table",z,[t("tbody",null,[(l(!0),o(i,null,d(u.value,(a,s)=>(l(),o(i,{key:s},[a.check=="ok"?(l(),o("tr",G,[t("td",null,[t("a",{href:s,target:"_blank"},c(s),9,I)]),t("td",null,c(a.status),1),t("td",null,c(a.check),1),t("td",null,[(l(!0),o(i,null,d(a.parentArr,n=>(l(),o("span",J,[t("a",{href:n,target:"_blank"},c(n),9,K)]))),256))])])):g("",!0)],64))),128))])]),r[4]||(r[4]=t("h2",null,"External",-1)),t("table",R,[t("tbody",null,[(l(!0),o(i,null,d(h.value,(a,s)=>(l(),o("tr",{key:s},[t("td",null,[t("a",{href:s,target:"_blank"},c(s),9,tt)]),t("td",null,c(a.status),1),t("td",null,c(a.check),1),t("td",null,[(l(!0),o(i,null,d(a.parentArr,n=>(l(),o("span",et,[t("a",{href:n,target:"_blank"},c(n),9,st)]))),256))])]))),128))])])],64))}},at=[v,T,B,L,O,V,D,F,W,q],m=P(rt);at.forEach(f=>{m.component(f.name,f)});m.use(M,{theme:{preset:N,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});m.use(j);m.use(v);m.mount("#crawler");
