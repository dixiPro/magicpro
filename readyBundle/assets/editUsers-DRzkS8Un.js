import{Y as N,Z as S,b as p,R as I,$ as M,I as w,c,o as i,a as t,L as y,F as k,G as P,K as R,y as C,A as v,C as h,ae as q,H as d,a0 as G,a1 as x,a2 as H,a3 as K,a4 as Q,a5 as Y,a6 as Z,a7 as z,a8 as J,a9 as O,aa as W,ab as X,ac as ee}from"./apiCall-CPsueVi4.js";import{s as te}from"./index-DQP_ltDA.js";const se={class:"container my-3"},ae={class:"col-1"},oe=["onClick"],ne={class:"col-1"},le=["textContent"],re={class:"col-2"},ce=["textContent"],ie={class:"col-2"},de=["textContent"],ue={class:"col-2"},me=["textContent"],pe={class:"col-2"},ve=["textContent"],he={key:0,class:"col-1"},fe=["onClick"],_e={class:"my-3 text-center"},be={class:"my-2"},we={class:"my-2"},ye={class:"my-2"},Ce={__name:"EditUsers",setup(f){const g=N(),$=S(),l=p([]),_=p(!1),n=p({name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"});let U=0;const o=p({show:!1,mode:null,header:null,button:null});async function m(e){const s="/a_dmin/api/editUsers";if(!_.value)try{return _.value=!0,(await q({url:s,data:e,logResult:!1})).data}catch(r){throw document.showToast(r,"error"),new Error("ошибка")}finally{_.value=!1}}async function D(){try{l.value=(await m({command:"getUserList",data:{}})).map(e=>(e.edit=!1,e)),document.showToast("Список считан")}catch{}}async function T(){if(await document.confirmDialog("Сохранить???"))try{const e=await m({command:"editUser",data:n.value});e.edit=!1,console.log(e),l.value[U]=e,n.value=e,document.showToast("Сохранено")}catch{}}async function V(e){if(await document.confirmDialog("Удалить?"))try{const s=await m({command:"deleteUser",data:{id:l.value[e].id}});l.value.splice(e,1)}catch{}}function E(e){U=e,n.value=l.value[e],o.value.show=!0,o.value.header="Изменить",o.value.mode="edit",o.value.header="Сохранить"}function L(){n.value={name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"},o.value.show=!0,o.value.header="Создать",o.value.mode="add",o.value.header="Создать"}async function A(){try{const e=await m({command:"addUser",data:n.value});e.edit=!1,l.value.push(e),o.value.show=!1}catch{}}return I(()=>{document.showToast=(e="",s="success")=>{const r=s==="success"?5e3:1e5;g.add({severity:s,detail:e,life:r}),s==="error"&&console.log(e)},document.confirmDialog=async e=>new Promise((s,r)=>{$.require({message:e,header:" ",acceptLabel:"Да",rejectLabel:"Нет",accept:()=>s(!0),reject:()=>s(!1)})}),D()}),M(()=>{}),(e,s)=>{const r=w("Dialog"),j=w("Toast"),B=w("ConfirmDialog");return i(),c(k,null,[t("div",se,[(i(!0),c(k,null,P(l.value,(a,b)=>(i(),c("div",{key:b,class:"row my-2"},[t("div",ae,[t("button",{onClick:F=>E(b),class:"fas fa-edit btn btn-sm btn-success"},null,8,oe)]),t("div",ne,[t("span",{textContent:d(a.id)},null,8,le)]),t("div",re,[t("span",{textContent:d(a.name)},null,8,ce)]),t("div",ie,[t("span",{textContent:d(a.email)},null,8,de)]),t("div",ue,[t("span",{textContent:d(a.password)},null,8,me)]),t("div",pe,[t("span",{textContent:d(a.role)},null,8,ve)]),a.edit?C("",!0):(i(),c("div",he,[t("button",{class:"fas fa-trash btn btn-sm btn-success",onClick:F=>V(b)},null,8,fe)]))]))),128)),t("div",_e,[t("button",{class:"btn btn-sm btn-success",onClick:s[0]||(s[0]=a=>L())},"add")])]),y(r,{visible:o.value.show,"onUpdate:visible":s[5]||(s[5]=a=>o.value.show=a),header:o.value.header,modal:"",style:{width:"400px"}},{default:R(()=>[t("div",null,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=a=>n.value.name=a),placeholder:"name"},null,512),[[h,n.value.name]])]),t("div",be,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=a=>n.value.email=a),placeholder:"email"},null,512),[[h,n.value.email]])]),t("div",we,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=a=>n.value.password=a),placeholder:"password"},null,512),[[h,n.value.password]])]),t("div",ye,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=a=>n.value.role=a),placeholder:"password"},null,512),[[h,n.value.role]])]),o.value.mode==="add"?(i(),c("button",{key:0,class:"btn btn-sm btn-success",onClick:A},"Создать")):C("",!0),o.value.mode==="edit"?(i(),c("button",{key:1,class:"btn btn-sm btn-success",onClick:T},"Сохранить")):C("",!0)]),_:1},8,["visible","header"]),y(j,{position:"bottom-right"}),y(B)],64)}}},Ue=[x,H,K,Q,Y,Z,z,J,O,te],u=G(Ce);Ue.forEach(f=>{u.component(f.name,f)});u.use(W,{theme:{preset:X,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});u.use(ee);u.use(x);u.mount("#edit_users");
