import{r as p,y as A,L,i as N,b as r,o as i,d as e,l as U,F as C,g as S,k as B,e as b,w as v,v as h,_ as F,h as c,M,T as k,N as P,O as Q,P as R,Q as I,R as O,S as W,U as X,V as Y,W as j,X as q,Y as z}from"./apiCall-BoC-CooK.js";import{s as G}from"./index-BZdHaCHA.js";import{_ as H}from"./ToastConfirm-tpuglp3F.js";const J={class:"container my-3"},K={class:"col-1"},Z=["onClick"],ee={class:"col-1"},te=["textContent"],se={class:"col-2"},ae=["textContent"],oe={class:"col-2"},ne=["textContent"],le={class:"col-2"},re=["textContent"],ie={class:"col-2"},ce=["textContent"],de={key:0,class:"col-1"},ue=["onClick"],me={class:"my-3 text-center"},pe={class:"my-2"},ve={class:"my-2"},he={class:"my-2"},_e={__name:"EditUsers",setup(_){const l=p([]),f=p(!1),n=p({name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"});let y=0;const o=p({show:!1,mode:null,header:null,button:null});async function u(t){const a="/a_dmin/api/editUsers";if(!f.value)try{return f.value=!0,(await F({url:a,data:t,logResult:!1})).data}catch(m){throw document.showToast(m,"error"),new Error("ошибка")}finally{f.value=!1}}async function x(){try{l.value=(await u({command:"getUserList",data:{}})).map(t=>(t.edit=!1,t)),document.showToast("Список считан")}catch{}}async function $(){if(await document.confirmDialog("Сохранить???"))try{const t=await u({command:"editUser",data:n.value});t.edit=!1,console.log(t),l.value[y]=t,n.value=t,document.showToast("Сохранено")}catch{}}async function g(t){if(await document.confirmDialog("Удалить?"))try{const a=await u({command:"deleteUser",data:{id:l.value[t].id}});l.value.splice(t,1)}catch{}}function V(t){y=t,n.value=l.value[t],o.value.show=!0,o.value.header="Изменить",o.value.mode="edit",o.value.header="Сохранить"}function D(){n.value={name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"},o.value.show=!0,o.value.header="Создать",o.value.mode="add",o.value.header="Создать"}async function E(){try{const t=await u({command:"addUser",data:n.value});t.edit=!1,l.value.push(t),o.value.show=!1}catch{}}return A(()=>{x()}),L(()=>{}),(t,a)=>{const m=N("Dialog");return i(),r(C,null,[e("div",J,[(i(!0),r(C,null,S(l.value,(s,w)=>(i(),r("div",{key:w,class:"row my-2"},[e("div",K,[e("button",{onClick:T=>V(w),class:"fas fa-edit btn btn-sm btn-success"},null,8,Z)]),e("div",ee,[e("span",{textContent:c(s.id)},null,8,te)]),e("div",se,[e("span",{textContent:c(s.name)},null,8,ae)]),e("div",oe,[e("span",{textContent:c(s.email)},null,8,ne)]),e("div",le,[e("span",{textContent:c(s.password)},null,8,re)]),e("div",ie,[e("span",{textContent:c(s.role)},null,8,ce)]),s.edit?b("",!0):(i(),r("div",de,[e("button",{class:"fas fa-trash btn btn-sm btn-success",onClick:T=>g(w)},null,8,ue)]))]))),128)),e("div",me,[e("button",{class:"btn btn-sm btn-success",onClick:a[0]||(a[0]=s=>D())},"add")])]),U(m,{visible:o.value.show,"onUpdate:visible":a[5]||(a[5]=s=>o.value.show=s),header:o.value.header,modal:"",style:{width:"400px"}},{default:B(()=>[e("div",null,[v(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=s=>n.value.name=s),placeholder:"name"},null,512),[[h,n.value.name]])]),e("div",pe,[v(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a[2]||(a[2]=s=>n.value.email=s),placeholder:"email"},null,512),[[h,n.value.email]])]),e("div",ve,[v(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a[3]||(a[3]=s=>n.value.password=s),placeholder:"password"},null,512),[[h,n.value.password]])]),e("div",he,[v(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a[4]||(a[4]=s=>n.value.role=s),placeholder:"password"},null,512),[[h,n.value.role]])]),o.value.mode==="add"?(i(),r("button",{key:0,class:"btn btn-sm btn-success",onClick:E},"Создать")):b("",!0),o.value.mode==="edit"?(i(),r("button",{key:1,class:"btn btn-sm btn-success",onClick:$},"Сохранить")):b("",!0)]),_:1},8,["visible","header"]),U(H)],64)}}},fe=[k,P,Q,R,I,O,W,X,Y,G],d=M(_e);fe.forEach(_=>{d.component(_.name,_)});d.use(j,{theme:{preset:q,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});d.use(z);d.use(k);d.mount("#edit_users");
