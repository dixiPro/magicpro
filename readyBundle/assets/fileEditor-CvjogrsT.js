import{q as k,r as d,s as N,x as V,y as w,z as v,A as _,b as $,o as x,I as g,J as F,j as B,e as M,k as y,l as P,d as u,h as C,N as T,T as S,O as W,P as A,Q as O,R as j,S as z,U as D,V as U,W as L,X as I,Y as K,Z as Q,_ as q}from"./apiCall-BbAjuLGo.js";import{s as J}from"./index-BspGk_zj.js";import{a as b,M as R,c as X}from"./javascript-53trRzPJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y=["id"],Z={__name:"AceFileEditor",props:k({fileExtention:{type:String,default:"html"},theme:{type:String,default:"monokai"},readOnly:{type:Boolean,default:!1},tabSize:{type:Number,default:4},wrap:{type:Boolean,default:!1},height:{type:Number,default:100}},{modelValue:{type:String,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(i){b.config.set("basePath","/vendor/magicpro/ace");const f=d(N()),a=i,n=V(i,"modelValue"),o=d(null);let e=null;function l(){const t={js:"ace/mode/javascript",css:"ace/mode/css"};return t[a.fileExtention]?t[a.fileExtention]:"ace/mode/text"}const p=t=>`ace/theme/${t}`;return w(()=>{l(),e=b.edit(f.value,{value:n.value,mode:l(),theme:p(a.theme),readOnly:a.readOnly,wrap:a.wrap,tabSize:a.tabSize,useWorker:!1}),e.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableEmmet:!0}),e.setFontSize(14),e.session.on("change",()=>{n.value=e.getValue()})}),v(n,t=>{if(!e)return;const r=e.getValue();t!==r&&e.setValue(t)}),_(()=>e?.destroy()),v(()=>a.fileExtention,t=>{const r=l();e?.session.setMode(r)}),v(()=>a.theme,t=>e?.setTheme(p(t))),(t,r)=>(x(),$("div",{ref_key:"el",ref:o,id:f.value,style:{width:"100%",height:"100%"}},null,8,Y))}},G={class:"d-flex gx-2 py-2 mx-0 align-items-center"},H={class:"flex-grow-1"},ee={__name:"FileEditor",props:{fileName:{type:String,default:"/design/1.txt"},width:{type:String,default:"800"},height:{type:String,default:"600"}},emits:["close"],setup(i,{emit:f}){const a=i,n=d(""),o=d(""),e=d(!1),l=async s=>{s.ctrlKey&&s.code==="KeyS"&&(console.log("save file"),s.stopImmediatePropagation(),s.preventDefault(),s.stopPropagation(),await t())};w(async()=>{n.value=a.fileName.split(".").pop();const s=await g({command:"loadFile",fileName:a.fileName});o.value=s.fileData,e.value=!0,window.addEventListener("keydown",l,{capture:!0})}),F(()=>{window.removeEventListener("keydown",l)});const p=d(!0);async function t(){console.log(o.value),await g({command:"saveFile",fileName:a.fileName,fileData:o.value}),document.showToast("Сохранен файл "+a.fileName)}async function r(){let s="";switch(n.value){case"css":{s=await prettier.format(o.value,{parser:"css",plugins:[prettierPlugins.postcss],tabWidth:4,printWidth:160});break}case"js":{s=await prettier.format(o.value,{parser:"babel",plugins:prettierPlugins,semi:!0,tabWidth:4,printWidth:120});break}default:return}document.showToast("Отформатировано"),o.value=s}const E=f;return(s,c)=>e.value?(x(),B(R,{key:0,visible:p.value,"onUpdate:visible":c[1]||(c[1]=h=>p.value=h),width:"props.width",height:"props.height",header:"Имя файла",onClose:c[2]||(c[2]=h=>{E("close"),e.value=!1})},{header:y(()=>[u("div",G,[u("div",H,C(i.fileName),1),u("div",{class:"mx-2"},[u("button",{class:"btn btn-sm btn-primary",onClick:t},"Save→")]),u("div",{class:""},[u("button",{class:"btn fas fa-magic btn-success",onClick:r})])])]),default:y(()=>[P(Z,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=h=>o.value=h),fileExtention:n.value,theme:"chrome"},null,8,["modelValue","fileExtention"])]),_:1},8,["visible"])):M("",!0)}},te=[S,W,A,O,j,z,D,U,L,J],m=T(ee);te.forEach(i=>{m.component(i.name,i)});m.use(I,{theme:{preset:K,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});m.use(Q);m.use(S);m.use(X());m.mount("#file_editor");Object.assign(globalThis,q);
