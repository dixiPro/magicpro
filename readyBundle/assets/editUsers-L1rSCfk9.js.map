{"version":3,"file":"editUsers-L1rSCfk9.js","sources":["../../../../packages/dixipro/magicpro/admin/js/app/EditUsers/EditUsers.vue","../../../../packages/dixipro/magicpro/admin/js/editUsers.js"],"sourcesContent":["<script setup>\nimport { ref, computed, onMounted, onUnmounted, watch, useId } from \"vue\";\nimport { apiCall, apiArt, translitString } from \"../apiCall\";\nimport { useToast } from \"primevue/usetoast\";\nconst toast = useToast();\nimport { useConfirm } from \"primevue/useconfirm\";\nconst confirm = useConfirm();\n\n\nconst allUsers = ref([]);\nconst apiActive = ref(false);\nconst newUser = ref({\n    \"name\": \"newUser\",\n    \"email\": \"barsik@barsik.com\",\n    \"password\": \"1234\",\n    \"role\": \"user\",\n});\nlet numerUserInAllUsers = 0; // –Ω–æ–º–µ—Ä —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ allUsers\nconst dialogUserForm = ref({\n    show: false,\n    mode: null,\n    header: null,\n    button: null\n});\n\n\n// —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ê–ü–ò\nasync function apiEditUser(data) {\n    const url = \"/a_dmin/api/editUsers\";\n    if (apiActive.value) return;\n    try {\n        apiActive.value = true;\n        const response = await apiCall({\n            url: url,\n            data: data,\n            logResult: false,\n        });\n        return response.data;\n    } catch (e) {\n        document.showToast(e, \"error\");\n        throw new Error(\"–æ—à–∏–±–∫–∞\");\n    } finally {\n        apiActive.value = false;\n    }\n}\n\nasync function readUsers() {\n    try {\n        allUsers.value = (await apiEditUser({\n            command: 'getUserList',\n            data: {}\n        })).map((el) => {\n            el.edit = false;\n            return el;\n\n\n        })\n        document.showToast('–°–ø–∏—Å–æ–∫ —Å—á–∏—Ç–∞–Ω');\n    } catch (error) {\n    }\n}\n\nasync function editUser() {\n    if (! await document.confirmDialog('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å???')) return;\n\n    try {\n        const res = await apiEditUser({\n            command: 'editUser',\n            data: newUser.value\n        });\n        res.edit = false;\n        console.log(res);\n        allUsers.value[numerUserInAllUsers] = res;\n        newUser.value = res;\n        document.showToast('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');\n    } catch (error) { }\n}\n\nasync function deleteUser(selectedUser) {\n\n    if (! await document.confirmDialog('–£–¥–∞–ª–∏—Ç—å?')) return;\n    try {\n        const res = await apiEditUser({\n            command: 'deleteUser',\n            data: { id: allUsers.value[selectedUser].id }\n        });\n        allUsers.value.splice(selectedUser, 1);\n    } catch (error) { }\n}\n\nfunction startEdit(selectedUser) {\n    numerUserInAllUsers = selectedUser;\n    newUser.value = allUsers.value[selectedUser];\n    dialogUserForm.value.show = true;\n    dialogUserForm.value.header = '–ò–∑–º–µ–Ω–∏—Ç—å';\n    dialogUserForm.value.mode = 'edit';\n    dialogUserForm.value.header = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';\n}\n\nfunction startAdd() {\n    newUser.value = {\n        \"name\": \"newUser\",\n        \"email\": \"barsik@barsik.com\",\n        \"password\": \"1234\",\n        \"role\": \"user\",\n    }\n    dialogUserForm.value.show = true;\n    dialogUserForm.value.header = '–°–æ–∑–¥–∞—Ç—å';\n    dialogUserForm.value.mode = 'add';\n    dialogUserForm.value.header = '–°–æ–∑–¥–∞—Ç—å';\n}\n\nasync function addUser() {\n    try {\n        const res = await apiEditUser({\n            command: 'addUser',\n            data: newUser.value\n        });\n        res.edit = false;\n        allUsers.value.push(res);\n        dialogUserForm.value.show = false;\n    } catch (error) { }\n}\n\n\nonMounted(() => {\n\n\n    // –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã\n    // —Ç–æ—Å—Ç—ã\n    // –≤—ã–≤–æ–¥–∏—Ç —Ç–æ—Å—Ç —É–∂–µ –≥–æ—Ç–æ–≤,  –Ω–µ –Ω–∞–¥–æ –Ω–∏—á–µ–≥–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—ã–∑—ã–≤–∞—Ç—å\n    // –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ document.confirmDialog('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å?');\n    document.showToast = (msg = \"\", severity = \"success\") => {\n\n        const life = severity === \"success\" ? 5000 : 100000;\n        toast.add({ severity: severity, detail: msg, life: life });\n        if (severity === \"error\") {\n            console.log(msg);\n        }\n    };\n    // –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞ –î–∞ –∏–ª–∏ –ù–µ—Ç\n    // –≤—ã–≤–æ–¥–∏—Ç —Ç–æ—Å—Ç —É–∂–µ –≥–æ—Ç–æ–≤,  –Ω–µ –Ω–∞–¥–æ –Ω–∏—á–µ–≥–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å\n    // –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ document.showToast('–°–æ–æ–±—â–µ–Ω–∏–µ');\n    document.confirmDialog = async (message) => {\n        return new Promise((resolve, reject) => {\n            confirm.require({\n                message,\n                header: \" \",\n                // icon: \"fas fa-question\",\n                acceptLabel: \"–î–∞\",\n                rejectLabel: \"–ù–µ—Ç\",\n                accept: () => resolve(true),\n                reject: () => resolve(false), // –∏–ª–∏ reject(), –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ—à–∏–±–∫—É\n            });\n        });\n    };\n\n    readUsers();\n});\n\nonUnmounted(() => {\n\n});\n\n</script>\n<template>\n    <div class=\"container my-3\">\n        <template v-for=\"(user, index) in allUsers\" :key=\"index\">\n            <div class=\"row my-2\">\n                <div class=\"col-1\">\n                    <button @click=\"startEdit(index)\" class=\"fas fa-edit btn btn-sm btn-success\"></button>\n                </div>\n\n                <div class=\"col-1\">\n                    <span v-text=\"user.id\"></span>\n\n                </div>\n                <div class=\"col-2\">\n                    <span v-text=\"user.name\"></span>\n                </div>\n                <div class=\"col-2\">\n                    <span v-text=\"user.email\"></span>\n                </div>\n                <div class=\"col-2\">\n                    <span v-text=\"user.password\"></span>\n                </div>\n                <div class=\"col-2\">\n                    <span v-text=\"user.role\"></span>\n                </div>\n\n\n\n                <div class=\"col-1\" v-if=\"!user.edit\">\n                    <button class=\"fas fa-trash btn btn-sm btn-success\" @click=\"deleteUser(index)\"></button>\n                </div>\n            </div>\n        </template>\n        <div class=\"my-3 text-center\">\n            <button class=\"btn btn-sm btn-success\" @click=\"startAdd()\">add</button>\n        </div>\n    </div>\n\n    <Dialog v-model:visible=\"dialogUserForm.show\" :header=\"dialogUserForm.header\" modal style=\"width: 400px\">\n        <div>\n            <input type=\"text\" class=\"form-control\" v-model=\"newUser.name\" placeholder=\"name\" />\n        </div>\n        <div class=\"my-2\">\n            <input type=\"text\" class=\"form-control\" v-model=\"newUser.email\" placeholder=\"email\" />\n        </div>\n        <div class=\"my-2\"><input type=\"text\" class=\"form-control\" v-model=\"newUser.password\" placeholder=\"password\" />\n        </div>\n        <div class=\"my-2\"><input type=\"text\" class=\"form-control\" v-model=\"newUser.role\" placeholder=\"password\" /></div>\n\n\n        <button class=\"btn btn-sm btn-success\" v-if=\"dialogUserForm.mode === 'add'\" @click=\"addUser\">–°–æ–∑–¥–∞—Ç—å</button>\n        <button class=\"btn btn-sm btn-success\" v-if=\"dialogUserForm.mode === 'edit'\"\n            @click=\"editUser\">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>\n\n    </Dialog>\n\n\n    <!-- —Ç–æ—Å—Ç—ã -->\n    <Toast position=\"bottom-right\"></Toast>\n    <!-- –î–∏–ª–æ–≥ –î–∞ –ù–µ—Ç -->\n    <ConfirmDialog></ConfirmDialog>\n</template>\n\n<style>\n.pointer {\n    cursor: pointer;\n}\n\n.icon-menue {\n    cursor: pointer;\n    font-size: 28px;\n}\n\n.icon-border {\n    border: 1px solid #777;\n}\n\n/* üîß –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è PrimeVue */\n:root {\n    --p-input-padding: 0.25rem 0.5rem;\n    --p-button-padding: 0.25rem 0.75rem;\n    --p-inputtext-font-size: 0.875rem;\n    --p-button-font-size: 0.875rem;\n    --p-border-radius: 0.25rem;\n    --p-dialog-padding: 1rem;\n    --p-dialog-header-padding: 0.5rem;\n    --p-dialog-content-padding: 0.5rem;\n    --p-dialog-footer-padding: 0.5rem;\n}\n\n/* –ù–µ–º–Ω–æ–≥–æ —É–∂–∏–º–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –∏ –∫–∞—Ä—Ç–æ—á–∫–∏ */\n.p-datatable,\n.p-card {\n    font-size: 0.875rem;\n}\n\n.p-inputtext,\n.p-dropdown,\n.p-multiselect,\n.p-calendar,\n.p-password {\n    min-height: 1.75rem !important;\n    line-height: 1.25rem !important;\n}\n\n/* –ö–Ω–æ–ø–∫–∏ */\n.p-button {\n    min-height: 1.75rem !important;\n    line-height: 1.25rem !important;\n}\n\n/* –î–∏–∞–ª–æ–≥–∏ */\n.p-dialog {\n    font-size: 0.875rem;\n}\n</style>\n","import { createApp } from \"vue\";\n\nimport PrimeVue from \"primevue/config\";\nimport Aura from \"@primeuix/themes/aura\";\n// import \"primeicons/primeicons.css\";\n\nimport ToastService from \"primevue/toastservice\";\nimport Toast from \"primevue/toast\";\nimport ConfirmDialog from \"primevue/confirmdialog\";\nimport ConfirmationService from \"primevue/confirmationservice\";\nimport Dialog from \"primevue/dialog\";\nimport Splitter from \"primevue/splitter\";\nimport SplitterPanel from \"primevue/splitterpanel\";\nimport ContextMenu from \"primevue/contextmenu\";\nimport Drawer from \"primevue/drawer\";\nimport FileUpload from \"primevue/fileupload\";\nimport InputText from \"primevue/inputtext\";\nimport Button from \"primevue/button\";\n\nconst components = [\n    //\n    ToastService,\n    Toast,\n    ConfirmDialog,\n    Dialog,\n    Splitter,\n    SplitterPanel,\n    ContextMenu,\n    Drawer,\n    FileUpload,\n    InputText,\n];\n\nimport EditUsers from \"./app/EditUsers/EditUsers.vue\";\nconst app = createApp(EditUsers);\n\n// —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤\ncomponents.forEach((component) => {\n    app.component(component.name, component);\n});\n\napp.use(PrimeVue, {\n    theme: {\n        preset: Aura,\n        options: {\n            cssLayer: { name: \"primevue\", order: \"theme, base, primevue\" },\n        },\n    },\n});\n\napp.use(ConfirmationService);\napp.use(ToastService);\n\napp.mount(\"#edit_users\");\n"],"names":["toast","useToast","confirm","useConfirm","allUsers","ref","apiActive","newUser","numerUserInAllUsers","dialogUserForm","apiEditUser","data","url","apiCall","e","readUsers","el","editUser","res","deleteUser","selectedUser","startEdit","startAdd","addUser","onMounted","msg","severity","life","message","resolve","reject","onUnmounted","_createElementVNode","_hoisted_1","_openBlock","_createElementBlock","_Fragment","_renderList","user","index","_hoisted_2","$event","_hoisted_4","_toDisplayString","_hoisted_6","_hoisted_8","_hoisted_10","_hoisted_12","_hoisted_14","_hoisted_16","_createVNode","_component_Dialog","_cache","_vModelText","_hoisted_17","_hoisted_18","_hoisted_19","_component_Toast","_component_ConfirmDialog","components","ToastService","Toast","ConfirmDialog","Dialog","Splitter","SplitterPanel","ContextMenu","Drawer","FileUpload","InputText","app","createApp","EditUsers","component","PrimeVue","Aura","ConfirmationService"],"mappings":"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"}