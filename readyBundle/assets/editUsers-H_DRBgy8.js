import{G as B,H as F,r as p,y as M,J as P,i as b,b as i,o as c,d as t,l as y,F as k,g as Q,k as R,e as C,w as v,v as h,Y as q,h as d,K as G,T as x,L as H,M as I,N as J,O as K,P as O,Q as W,R as Y,S as z,U as X,V as Z,W as ee}from"./apiCall-CqgbXul4.js";import{s as te}from"./index-DQnFNzjY.js";const se={class:"container my-3"},ae={class:"col-1"},oe=["onClick"],ne={class:"col-1"},le=["textContent"],re={class:"col-2"},ie=["textContent"],ce={class:"col-2"},de=["textContent"],ue={class:"col-2"},me=["textContent"],pe={class:"col-2"},ve=["textContent"],he={key:0,class:"col-1"},fe=["onClick"],_e={class:"my-3 text-center"},we={class:"my-2"},be={class:"my-2"},ye={class:"my-2"},Ce={__name:"EditUsers",setup(f){const g=B(),$=F(),l=p([]),_=p(!1),n=p({name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"});let U=0;const o=p({show:!1,mode:null,header:null,button:null});async function m(e){const s="/a_dmin/api/editUsers";if(!_.value)try{return _.value=!0,(await q({url:s,data:e,logResult:!1})).data}catch(r){throw document.showToast(r,"error"),new Error("ошибка")}finally{_.value=!1}}async function T(){try{l.value=(await m({command:"getUserList",data:{}})).map(e=>(e.edit=!1,e)),document.showToast("Список считан")}catch{}}async function D(){if(await document.confirmDialog("Сохранить???"))try{const e=await m({command:"editUser",data:n.value});e.edit=!1,console.log(e),l.value[U]=e,n.value=e,document.showToast("Сохранено")}catch{}}async function V(e){if(await document.confirmDialog("Удалить?"))try{const s=await m({command:"deleteUser",data:{id:l.value[e].id}});l.value.splice(e,1)}catch{}}function E(e){U=e,n.value=l.value[e],o.value.show=!0,o.value.header="Изменить",o.value.mode="edit",o.value.header="Сохранить"}function L(){n.value={name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"},o.value.show=!0,o.value.header="Создать",o.value.mode="add",o.value.header="Создать"}async function A(){try{const e=await m({command:"addUser",data:n.value});e.edit=!1,l.value.push(e),o.value.show=!1}catch{}}return M(()=>{document.showToast=(e="",s="success")=>{const r=s==="success"?5e3:1e5;g.add({severity:s,detail:e,life:r}),s==="error"&&console.log(e)},document.confirmDialog=async e=>new Promise((s,r)=>{$.require({message:e,header:" ",acceptLabel:"Да",rejectLabel:"Нет",accept:()=>s(!0),reject:()=>s(!1)})}),T()}),P(()=>{}),(e,s)=>{const r=b("Dialog"),N=b("Toast"),S=b("ConfirmDialog");return c(),i(k,null,[t("div",se,[(c(!0),i(k,null,Q(l.value,(a,w)=>(c(),i("div",{key:w,class:"row my-2"},[t("div",ae,[t("button",{onClick:j=>E(w),class:"fas fa-edit btn btn-sm btn-success"},null,8,oe)]),t("div",ne,[t("span",{textContent:d(a.id)},null,8,le)]),t("div",re,[t("span",{textContent:d(a.name)},null,8,ie)]),t("div",ce,[t("span",{textContent:d(a.email)},null,8,de)]),t("div",ue,[t("span",{textContent:d(a.password)},null,8,me)]),t("div",pe,[t("span",{textContent:d(a.role)},null,8,ve)]),a.edit?C("",!0):(c(),i("div",he,[t("button",{class:"fas fa-trash btn btn-sm btn-success",onClick:j=>V(w)},null,8,fe)]))]))),128)),t("div",_e,[t("button",{class:"btn btn-sm btn-success",onClick:s[0]||(s[0]=a=>L())},"add")])]),y(r,{visible:o.value.show,"onUpdate:visible":s[5]||(s[5]=a=>o.value.show=a),header:o.value.header,modal:"",style:{width:"400px"}},{default:R(()=>[t("div",null,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=a=>n.value.name=a),placeholder:"name"},null,512),[[h,n.value.name]])]),t("div",we,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=a=>n.value.email=a),placeholder:"email"},null,512),[[h,n.value.email]])]),t("div",be,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=a=>n.value.password=a),placeholder:"password"},null,512),[[h,n.value.password]])]),t("div",ye,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=a=>n.value.role=a),placeholder:"password"},null,512),[[h,n.value.role]])]),o.value.mode==="add"?(c(),i("button",{key:0,class:"btn btn-sm btn-success",onClick:A},"Создать")):C("",!0),o.value.mode==="edit"?(c(),i("button",{key:1,class:"btn btn-sm btn-success",onClick:D},"Сохранить")):C("",!0)]),_:1},8,["visible","header"]),y(N,{position:"bottom-right"}),y(S)],64)}}},Ue=[x,H,I,J,K,O,W,Y,z,te],u=G(Ce);Ue.forEach(f=>{u.component(f.name,f)});u.use(X,{theme:{preset:Z,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});u.use(ee);u.use(x);u.mount("#edit_users");
