import{V as S,W as C,P as E,X as P,b as k,c as o,o as l,a as t,F as d,D as f,v as g,E as c,Y as T,Z as y,_ as B,$ as L,a0 as O,a1 as V,a2 as D,a3 as F,a4 as W,a5 as M,a6 as N,a7 as j,a8 as q}from"./index-DlZXj8Km.js";import{s as H}from"./index-DXmzaT4Q.js";const Q={class:"my-2"},U={class:"table table-sm table-bordered"},X={key:0},Y=["href"],Z={class:"me-2"},z=["href"],G={class:"table table-sm table-bordered"},I={key:0},J=["href"],K={class:"me-2"},R=["href"],tt={class:"table table-sm table-bordered"},et=["href"],rt={class:"me-2"},st=["href"],at={__name:"Crawler",setup(m){S(),C(),E(()=>{console.log("startCrawler")}),P(()=>{});const u=k({}),i=k({}),h=k(!1);function b(s){if(!h.value)return new Promise(async(a,r)=>{try{const e=await fetch(s);if(!e.ok)return r({status:e.status,statusText:e.statusText,error:`HTTP ${e.status}`});const n=await e.text(),A=[...new DOMParser().parseFromString(n,"text/html").querySelectorAll("a")].map(x=>x.getAttribute("href")).filter(Boolean);a(A)}catch(e){r({status:null,statusText:null,error:e.message})}})}async function w(s,a){if(h.value)return;await _(s,a);let r={};Object.keys(u.value).sort().forEach(e=>{r[e]=u.value[e]}),u.value=r,await $(),r={},Object.keys(i.value).sort().forEach(e=>{r[e]=i.value[e]}),i.value=r}async function $(){if(!h.value)for(let s in i.value)try{await b(s),i.value[s].status="done",i.value[s].check="ok"}catch(a){i.value[s].check=a.error}}async function _(s,a){if(h.value||["#","/a_dmin","/f_ilament"].some(n=>s.startsWith(n)))return;if(["//","http://","https://"].some(n=>s.startsWith(n))){s in i.value||(i.value[s]={status:"reading",check:"unknown",parentArr:[]}),i.value[s].parentArr.push(a);return}if(s in u.value){u.value[s].check!="ok"&&u.value[s].parentArr.push(a);return}u.value[s]={status:"reading",check:"unknown",parentArr:[a]};try{const n=await b(s);u.value[s].check="ok";for(const v of n){if(h.value)return;await _(v,s)}}catch(n){u.value[s].check=n.error}finally{u.value[s].status="done"}}return(s,a)=>(l(),o(d,null,[a[2]||(a[2]=t("h1",null,"Crawler 0.5",-1)),t("div",Q,[t("button",{class:"btn btn-primary fas fa-angle-right",onClick:a[0]||(a[0]=r=>w("/",""))}),t("button",{class:"btn btn-danger fas fa-stop ms-3",onClick:a[1]||(a[1]=r=>h.value=!0)})]),a[3]||(a[3]=t("h3",null,"Error",-1)),t("table",U,[t("tbody",null,[(l(!0),o(d,null,f(u.value,(r,e)=>(l(),o(d,{key:e},[r.check!="ok"?(l(),o("tr",X,[t("td",null,[t("a",{href:e,target:"_blank"},c(e),9,Y)]),t("td",null,c(r.status),1),t("td",null,c(r.check),1),t("td",null,[(l(!0),o(d,null,f(r.parentArr,n=>(l(),o("span",Z,[t("a",{href:n,target:"_blank"},c(n),9,z)]))),256))])])):g("",!0)],64))),128))])]),a[4]||(a[4]=t("h3",null,"Ok",-1)),t("table",G,[t("tbody",null,[(l(!0),o(d,null,f(u.value,(r,e)=>(l(),o(d,{key:e},[r.check=="ok"?(l(),o("tr",I,[t("td",null,[t("a",{href:e,target:"_blank"},c(e),9,J)]),t("td",null,c(r.status),1),t("td",null,c(r.check),1),t("td",null,[(l(!0),o(d,null,f(r.parentArr,n=>(l(),o("span",K,[t("a",{href:n,target:"_blank"},c(n),9,R)]))),256))])])):g("",!0)],64))),128))])]),a[5]||(a[5]=t("h2",null,"External",-1)),t("table",tt,[t("tbody",null,[(l(!0),o(d,null,f(i.value,(r,e)=>(l(),o("tr",{key:e},[t("td",null,[t("a",{href:e,target:"_blank"},c(e),9,et)]),t("td",null,c(r.status),1),t("td",null,c(r.check),1),t("td",null,[(l(!0),o(d,null,f(r.parentArr,n=>(l(),o("span",rt,[t("a",{href:n,target:"_blank"},c(n),9,st)]))),256))])]))),128))])])],64))}},nt=[y,B,L,O,V,D,F,W,M,H],p=T(at);nt.forEach(m=>{p.component(m.name,m)});p.use(N,{theme:{preset:j,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});p.use(q);p.use(y);p.mount("#crawler");
