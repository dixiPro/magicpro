import{V as N,W as P,b as p,P as S,X as I,G as b,c as i,o as c,a as t,J as y,F as k,D as M,I as q,v as C,y as v,z as f,E as d,Y as z,Z as x,_ as G,$ as J,a0 as Q,a1 as R,a2 as W,a3 as X,a4 as Y,a5 as Z,a6 as H,a7 as K,a8 as O}from"./index-DlZXj8Km.js";import{s as ee}from"./index-DXmzaT4Q.js";import{c as te}from"./apiCall-BoJqVP3F.js";const se={class:"container my-3"},ae={class:"col-1"},oe=["onClick"],ne={class:"col-1"},le=["textContent"],re={class:"col-2"},ie=["textContent"],ce={class:"col-2"},de=["textContent"],ue={class:"col-2"},me=["textContent"],pe={class:"col-2"},ve=["textContent"],fe={key:0,class:"col-1"},he=["onClick"],_e={class:"my-3 text-center"},we={class:"my-2"},be={class:"my-2"},ye={class:"my-2"},Ce={__name:"EditUsers",setup(h){const g=N(),$=P(),l=p([]),_=p(!1),n=p({name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"});let U=0;const o=p({show:!1,mode:null,header:null,button:null});async function m(e){const s="/a_dmin/api/editUsers";if(!_.value)try{return _.value=!0,(await te({url:s,data:e,logResult:!1})).data}catch(r){throw document.showToast(r,"error"),new Error("ошибка")}finally{_.value=!1}}async function D(){try{l.value=(await m({command:"getUserList",data:{}})).map(e=>(e.edit=!1,e)),document.showToast("Список считан")}catch{}}async function T(){if(await document.confirmDialog("Сохранить???"))try{const e=await m({command:"editUser",data:n.value});e.edit=!1,console.log(e),l.value[U]=e,n.value=e,document.showToast("Сохранено")}catch{}}async function V(e){if(await document.confirmDialog("Удалить?"))try{const s=await m({command:"deleteUser",data:{id:l.value[e].id}});l.value.splice(e,1)}catch{}}function E(e){U=e,n.value=l.value[e],o.value.show=!0,o.value.header="Изменить",o.value.mode="edit",o.value.header="Сохранить"}function L(){n.value={name:"newUser",email:"barsik@barsik.com",password:"1234",role:"user"},o.value.show=!0,o.value.header="Создать",o.value.mode="add",o.value.header="Создать"}async function A(){try{const e=await m({command:"addUser",data:n.value});e.edit=!1,l.value.push(e),o.value.show=!1}catch{}}return S(()=>{document.showToast=(e="",s="success")=>{const r=s==="success"?5e3:1e5;g.add({severity:s,detail:e,life:r}),s==="error"&&console.log(e)},document.confirmDialog=async e=>new Promise((s,r)=>{$.require({message:e,header:" ",acceptLabel:"Да",rejectLabel:"Нет",accept:()=>s(!0),reject:()=>s(!1)})}),D()}),I(()=>{}),(e,s)=>{const r=b("Dialog"),j=b("Toast"),B=b("ConfirmDialog");return c(),i(k,null,[t("div",se,[(c(!0),i(k,null,M(l.value,(a,w)=>(c(),i("div",{key:w,class:"row my-2"},[t("div",ae,[t("button",{onClick:F=>E(w),class:"fas fa-edit btn btn-sm btn-success"},null,8,oe)]),t("div",ne,[t("span",{textContent:d(a.id)},null,8,le)]),t("div",re,[t("span",{textContent:d(a.name)},null,8,ie)]),t("div",ce,[t("span",{textContent:d(a.email)},null,8,de)]),t("div",ue,[t("span",{textContent:d(a.password)},null,8,me)]),t("div",pe,[t("span",{textContent:d(a.role)},null,8,ve)]),a.edit?C("",!0):(c(),i("div",fe,[t("button",{class:"fas fa-trash btn btn-sm btn-success",onClick:F=>V(w)},null,8,he)]))]))),128)),t("div",_e,[t("button",{class:"btn btn-sm btn-success",onClick:s[0]||(s[0]=a=>L())},"add")])]),y(r,{visible:o.value.show,"onUpdate:visible":s[5]||(s[5]=a=>o.value.show=a),header:o.value.header,modal:"",style:{width:"400px"}},{default:q(()=>[t("div",null,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=a=>n.value.name=a),placeholder:"name"},null,512),[[f,n.value.name]])]),t("div",we,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=a=>n.value.email=a),placeholder:"email"},null,512),[[f,n.value.email]])]),t("div",be,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=a=>n.value.password=a),placeholder:"password"},null,512),[[f,n.value.password]])]),t("div",ye,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=a=>n.value.role=a),placeholder:"password"},null,512),[[f,n.value.role]])]),o.value.mode==="add"?(c(),i("button",{key:0,class:"btn btn-sm btn-success",onClick:A},"Создать")):C("",!0),o.value.mode==="edit"?(c(),i("button",{key:1,class:"btn btn-sm btn-success",onClick:T},"Сохранить")):C("",!0)]),_:1},8,["visible","header"]),y(j,{position:"bottom-right"}),y(B)],64)}}},Ue=[x,G,J,Q,R,W,X,Y,Z,ee],u=z(Ce);Ue.forEach(h=>{u.component(h.name,h)});u.use(H,{theme:{preset:K,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});u.use(O);u.use(x);u.mount("#edit_users");
