import{r as P,c as H,a as _e,t as vt,u as Fe,b as T,o as k,d as h,e as U,f as u,w as Q,v as be,g as R,n as pe,h as yt,F as ae,i as me,j as se,k as ce,l as z,m as B,p as Ae,q as Ke,s as _t,x as bt,y as wt,z as Te,A as W,B as kt,C as ee,D as we,E as I,G as Se,H as Ue,I as Ge,J as $t,K as xt,_ as St,L as Tt,T as ct,M as Ct,N as Dt,O as Et,P as Pt,Q as Ot,R as At,S as Lt,U as Nt,V as Rt,W as Vt,X as Bt,Y as Ft,Z as Kt}from"./translate-DYXq8MLH.js";import{s as Ut}from"./index-DjoaJ7DT.js";import{d as Mt,a as dt,_ as zt,c as It}from"./FileManager-UOIBavhe.js";import{_ as Ht}from"./_plugin-vue_export-helper-DlAUqK2U.js";async function ut(e,t=2){try{return await prettier.format(e,{parser:"php",plugins:prettierPlugins,tabWidth:t})}catch(n){throw console.error("Ошибка при форматировании Php:",n),new Error("Ошибка при форматировании Php")}}async function Wt(e,t=2){let n=[],r=e.replace(/@php([\s\S]*?)@endphp/g,(l,c)=>{const o=n.length;return n.push(l),`<!--___PHP____${o}-->`}),i=[];r=r.replace(/@extends\s*\(\s*['"][^)]+?\[[\s\S]*?\]\s*\)/g,l=>{const c=i.length;return i.push(l),`<!--___EXTENDS____${c}-->`});let s=[];r=r.replace(/@props\s*\(\s*\[[\s\S]*?\]\s*\)/g,l=>{const c=s.length;return s.push(l),`<!--___PROPS____${c}-->`});let a=[];r=r.replace(/{{--([\s\S]*?)--}}/g,(l,c)=>{const o=a.length;return a.push(l),`<!--___COMMENT____${o}-->`}),n.length>0&&(n=await Promise.all(n.map(l=>jt(l,t))));try{r=await prettier.format(r,{parser:"html",plugins:[prettierPlugins.html],tabWidth:t,printWidth:160})}catch(l){const c=l.message.split(`
`).map(o=>o.replace(/^\s+/,"")).map(o=>o.replace(/For more info.*/,"")).filter(o=>!o.includes("at")).join(`
`);document.showToast(c,"error")}return r=Xt(r,t),r=r.replace(/<!--___PHP____(\d+)-->/g,(l,c)=>n[c]),r=r.replace(/<!--___PROPS____(\d+)-->/g,(l,c)=>s[c]),r=r.replace(/<!--___COMMENT____(\d+)-->/g,(l,c)=>a[c]),r=r.replace(/<!--___EXTENDS____(\d+)-->/g,(l,c)=>i[c]),r}async function jt(e,t){e=e.replace(/@php\s*/g,"").replace(/\s*@endphp/g,"");let n=`<?php
${e}`,r=await ut(n,t);return r=r.replace(/^<\?php\s*/,"").trim(),r=r.split(`
`).map(i=>" ".repeat(t)+i).join(`
`),r=`@php
${r}
@endphp`,r}function Xt(e,t=2){const n=e.split(`
`);let r=0;const i=[];for(let s of n){let a=Yt(s);for(let l of a){let c=qt(l);l.includes("<!--___PHP____")?(l=l.replace(/^\s+/,""),i.push(l)):(r=r+c.ident,i.push(" ".repeat(r*t)+c.line),r=r+c.after)}}return i.join(`
`)}function Yt(e){const t=e.match(/^(\s*)/),n=t?t[1]:"",r=e.split(/(?=@\w+)/).map(i=>i.trim()).filter(Boolean);return r.length<=1?[e]:r.map(i=>n+i)}function qt(e){const t={if:{ident:0,after:1},elseif:{ident:-1,after:1},else:{ident:-1,after:1},endif:{ident:-1,after:0},section:{ident:0,after:1,extended:{ident:0,after:0}},endsection:{ident:-1,after:0},foreach:{ident:0,after:1},endforeach:{ident:-1,after:0},forelse:{ident:0,after:1},endforelse:{ident:-1,after:0},for:{ident:0,after:1},endfor:{ident:-1,after:0},yield:{ident:1,after:-1},while:{ident:0,after:1},endwhile:{ident:-1,after:0},section:{ident:0,after:1},endsection:{ident:-1,after:0},switch:{ident:0,after:1},case:{ident:-1,after:1},endswitch:{ident:-1,after:0},endcase:{ident:-1,after:0},php:{ident:0,after:1},endphp:{ident:-1,after:0},livewire:{ident:0,after:1},endlivewire:{ident:-1,after:0},component:{ident:0,after:1},endcomponent:{ident:-1,after:0},slot:{ident:0,after:1},endslot:{ident:-1,after:0},props:{ident:0,after:0},error:{ident:0,after:1},enderror:{ident:-1,after:0},once:{ident:0,after:1},endonce:{ident:-1,after:0},push:{ident:0,after:1},endpush:{ident:-1,after:0},stack:{ident:0,after:1},endstack:{ident:-1,after:0},verbatim:{ident:0,after:1},endverbatim:{ident:-1,after:0},can:{ident:0,after:1},endcan:{ident:-1,after:0},cannot:{ident:0,after:1},endcannot:{ident:-1,after:0},auth:{ident:0,after:1},endauth:{ident:-1,after:0},guest:{ident:0,after:1},endguest:{ident:-1,after:0},mproauth:{ident:0,after:1},endmproauth:{ident:-1,after:0}};let n=(e.match(/@\w+/)||[null])[0];if(!n)return{ident:0,after:0,line:e};if(n=n.replace("@",""),!t[n])return{ident:0,after:0,line:e};let r=e.replace(new RegExp(`${n}\\s*\\(`,"g"),`${n}(`),i=t[n];return i.line=r,i.extended&&(r.match(new RegExp(`${n}\\(([^)]*)\\)`))||[null,""])[1].split(",").length>1?(i=t[n].extended,i.line=r,res):i}function Zt(e){const t={};let n=e.match(/\{% *setMeta\('title', *'([^']+)'/);return t.title=n?n[1]:null,n=e.match(/\{% *setMeta\('htmlDescr', *'([^']+)'/),t.description=n?n[1].trim():null,n=e.match(/\{% *setMeta\('keywords', *'([^']+)'/),t.keywords=n?n[1].trim():null,n=e.match(/\{% *setMeta\('h1', *'([^']+)'/),t.h1=n?n[1].trim():null,console.log(t),` @extends('magic::main',[
  'title' => '${t.title}',
  'description' => '${t.description}',
  'keywords' => '${t.keywords}'
])
  

<h1>${t.h1}</h1>

`+e}const de=Mt("article",()=>{const e=P({}),t=H(()=>{if(e.value.name!=="")return/^[a-z0-9_-]+$/i.test(e.value.name)}),n=H(()=>/{%\s*.*?\s*%}/.test(e.value.body)),r=P(!1),i=P(!1),s=P(!1),a=P(!1),l="chrome",c=["chrome","monokai","dracula","twilight"],o=P("tree"),d=P(!1),p=P(""),f=P("");async function m(g){const v=await _e({command:"getById",id:g});e.value=_(v),history.pushState(g,null,"#"+g),d.value=!0,document.title=e.value.title}function _(g){let v=g.routeParams;(Array.isArray(v)||v===null||typeof v!="object")&&(v={});const{adminOnly:w=!1,useController:K=!0,getEnable:q=!1,utmParamsEnable:X=!0,bindKeys:le=!1,keysArr:ye=[]}=v;return g.routeParams={useController:K,adminOnly:w,getEnable:q,utmParamsEnable:X,bindKeys:le,keysArr:ye},g}async function $(){e.value=await _e({command:"saveById",article:e.value}),document.showToast("Сохранено")}async function D(){try{const g=await _e({command:"getDefaultController",id:1});e.value.controller=g.controller}catch(g){console.log(g)}}async function A(g){try{const v=await _e({command:"articleByName",name:g});window.open(location.pathname+"#"+v.id,"_blank")}catch{}}async function V(){try{const g=await _e({command:"getDefaultLiveWareController",id:1});e.value.controller=g.controller}catch(g){console.log(g)}}async function M(g){try{return await _e({command:"search",text:g})}catch(v){console.log(v)}}async function y(){const g=await Wt(e.value.body,2);e.value.body=g;const v=await ut(e.value.controller,2);e.value.controller=v,document.showToast("Отформатировано")}function S(){e.value.name=vt(e.value.title.trim())}const E=g=>{if(g.ctrlKey&&g.code==="KeyS"){g.preventDefault(),$();return}if(g.altKey&&g.code==="Digit4"){addPannel.value=!addPannel.value,g.preventDefault();return}if(g.altKey&&g.code==="Digit6"){splitStatusEditorObj.value.set("hideController"),g.preventDefault();return}if(g.altKey&&g.code==="Digit5"){splitStatusEditorObj.value.set("hideBlade"),g.preventDefault();return}if(g.altKey&&g.code==="Digit3"){const v=splitTreeStatusObj.value.status=="hideTree"?"normal":"hideTree";splitTreeStatusObj.value.set(v),g.preventDefault();return}};function x(){e.value.body=Zt(e.value.body)}const O=P(),F=P("open"),j=P(),ue=P("full");return window.addEventListener("keydown",E),{article:e,statusHelp:r,statusAddPannel:i,statusFileManager:s,aceTheme:l,aceThemes:c,hasTwig:n,statusTranslitButton:t,hasTwig:n,statusLeftPannel:o,statusAutocompletePannel:a,toggleTreeSplitter:O,modeTreeSplitter:F,toggleEditorSplitter:j,modeEditorSplitter:ue,searchTextController:p,searchTextView:f,articleReady:d,loadRec:m,saveRec:$,getController:D,getLiveWareController:V,gotoArticleByName:A,formatDocument:y,translit:S,convertFromMro:x,search:M}}),Jt={class:"row gx-2 py-2 mx-0",style:{background:"#ffff001f"}},Gt={class:"col-auto"},Qt=["href"],en={key:1,class:"btn btn-sm btn-secondary fas fa-external-link-alt"},tn={class:"col-3"},nn={class:"input-group input-group-sm"},rn={class:"col-3"},an={class:"input-group input-group-sm"},sn={class:"col-1"},ln={class:"input-group input-group-sm"},on=["placeholder"],cn={class:"col-auto"},dn={key:0,class:"col-auto"},un={class:"col-auto align-self-center"},pn={class:"col-auto"},fn={class:"col-auto"},hn=["value"],gn={class:"col text-end"},mn={__name:"TopMenu",setup(e){const t=de(),{t:n}=Fe(),r=P(""),i=H(()=>t.article.name==="index"?"/":"/"+t.article.name);return(s,a)=>(k(),T("div",Jt,[h("div",Gt,[u(t).article.isRoute?(k(),T("a",{key:0,target:"_blank",class:"fas fa-external-link-alt btn btn-sm btn-primary",href:i.value},null,8,Qt)):(k(),T("span",en))]),h("div",tn,[h("div",nn,[Q(h("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":a[0]||(a[0]=l=>u(t).article.name=l)},null,512),[[be,u(t).article.name]]),u(t).statusTranslitButton?U("",!0):(k(),T("button",{key:0,class:"btn btn-sm btn-primary",onClick:a[1]||(a[1]=l=>u(t).translit())},"Translit→"))])]),h("div",rn,[h("div",an,[Q(h("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":a[2]||(a[2]=l=>u(t).article.title=l)},null,512),[[be,u(t).article.title]]),h("button",{class:"btn btn-sm btn-primary",onClick:a[3]||(a[3]=l=>u(t).saveRec())},R(u(n)("save")),1)])]),h("div",sn,[h("div",ln,[Q(h("input",{placeholder:u(n)("goto_article"),type:"text",class:"form-control","onUpdate:modelValue":a[4]||(a[4]=l=>r.value=l)},null,8,on),[[be,r.value]]),h("button",{class:"btn btn-primary fas fa-angle-right",onClick:a[5]||(a[5]=l=>u(t).gotoArticleByName(r.value))})])]),h("div",cn,[h("span",{class:pe(["btn btn-success",{"fas fas fa-sitemap":u(t).modeTreeSplitter=="hidden","fas fa-ellipsis-h":u(t).modeTreeSplitter==="open"}]),onClick:a[6]||(a[6]=l=>u(t).toggleTreeSplitter())},null,2)]),u(t).article.routeParams.useController?(k(),T("div",dn,[h("span",{class:pe(["btn btn-success",{"fas fa-angle-left":u(t).modeEditorSplitter==="full","fas fa-angle-right":u(t).modeEditorSplitter==="view","fa fa-columns":u(t).modeEditorSplitter==="controller"}]),onClick:a[7]||(a[7]=l=>u(t).toggleEditorSplitter())},null,2)])):U("",!0),h("div",un,[h("button",{class:"btn fas fa-magic btn-success",onClick:a[8]||(a[8]=l=>u(t).formatDocument())},"1")]),h("div",pn,[h("button",{onClick:a[9]||(a[9]=l=>u(t).statusHelp=!u(t).statusHelp),class:"fas fa-question btn btn-success"})]),h("div",fn,[Q(h("select",{"onUpdate:modelValue":a[10]||(a[10]=l=>u(t).aceTheme=l),class:"form-select form-select-sm"},[(k(!0),T(ae,null,me(u(t).aceThemes,l=>(k(),T("option",{key:l,value:l},R(l),9,hn))),128))],512),[[yt,u(t).aceTheme]])]),h("div",gn,[u(t).hasTwig?(k(),T("button",{key:0,class:"btn btn-success fas fa-sync-alt btn-sm me-2",onClick:a[11]||(a[11]=l=>u(t).convertFromMro())})):U("",!0),h("button",{class:"btn btn-success fas fa-folder-open",onClick:a[12]||(a[12]=l=>u(t).statusFileManager=!u(t).statusFileManager)}),h("button",{class:"ms-1 btn btn-success fas fa-lightbulb",onClick:a[13]||(a[13]=l=>u(t).statusAutocompletePannel=!u(t).statusAutocompletePannel)}),h("button",{class:"ms-1 btn btn-success fas fa-bars",onClick:a[14]||(a[14]=l=>u(t).statusAddPannel=!u(t).statusAddPannel)})])]))}},vn={class:""},yn={class:"my-2 d-flex"},_n={class:"nowrap"},bn={class:"ms-2"},wn={class:"d-flex my-2"},kn={class:"nowrap"},$n={class:"ms-2"},xn={class:"my-2 d-flex"},Sn={class:"nowrap"},Tn={class:"ms-2"},Cn={key:0},Dn={class:"d-flex my-2"},En={class:"nowrap"},Pn={class:"ms-2"},On={class:"d-flex my-2"},An={class:"nowrap"},Ln={class:"ms-2"},Nn={class:"d-flex my-2"},Rn={class:"nowrap"},Vn={class:"ms-2"},Bn={key:0},Fn={key:0},Kn={key:1},Un={class:"d-table"},Mn={class:"d-table-cell px-1 py-1 align-middle",style:{"min-width":"300px"}},zn=["onUpdate:modelValue"],In={class:"d-table-cell px-1 py-1"},Hn=["onClick"],Wn={class:"d-table-cell px-1 py-1"},jn=["onClick"],Xn={class:"d-table-cell px-1 py-1"},Yn=["onClick"],qn={class:"mt-2"},Zn={class:"row my-2"},Jn={class:"col-9"},Gn={class:"col-1"},Qn={key:1,class:"fas fa-plus"},er={key:2,class:"d-flex my-3"},tr={class:"nowrap"},nr={class:"ms-2"},rr={class:"my-2"},ar={key:0},sr={key:0},lr={key:1},or={key:0},ir={key:1},cr={__name:"RouteParam",setup(e){const t=de(),{t:n}=Fe(),r=P(""),i=P("");return(s,a)=>{const l=se("ToggleSwitch"),c=se("Drawer");return k(),ce(c,{visible:u(t).statusAddPannel,"onUpdate:visible":a[10]||(a[10]=o=>u(t).statusAddPannel=o),header:u(n)("route_params"),position:"right",style:{width:"700px"}},{default:z(()=>[h("div",vn,[h("div",yn,[h("div",_n,[B(l,{modelValue:u(t).article.menuOn,"onUpdate:modelValue":a[0]||(a[0]=o=>u(t).article.menuOn=o)},null,8,["modelValue"])]),h("div",bn,R(u(n)("menu_on")),1)]),h("div",wn,[h("div",kn,[B(l,{modelValue:u(t).article.routeParams.useController,"onUpdate:modelValue":a[1]||(a[1]=o=>u(t).article.routeParams.useController=o)},null,8,["modelValue"])]),h("div",$n,R(u(n)("use_controller")),1)]),h("div",xn,[h("div",Sn,[B(l,{modelValue:u(t).article.isRoute,"onUpdate:modelValue":a[2]||(a[2]=o=>u(t).article.isRoute=o)},null,8,["modelValue"])]),h("div",Tn,R(u(n)("is_route")),1)]),u(t).article.isRoute?(k(),T("div",Cn,[h("div",Dn,[h("div",En,[B(l,{modelValue:u(t).article.routeParams.adminOnly,"onUpdate:modelValue":a[3]||(a[3]=o=>u(t).article.routeParams.adminOnly=o)},null,8,["modelValue"])]),h("div",Pn,R(u(n)("only_admin")),1)]),h("div",On,[h("div",An,[B(l,{modelValue:u(t).article.routeParams.utmParamsEnable,"onUpdate:modelValue":a[4]||(a[4]=o=>u(t).article.routeParams.utmParamsEnable=o)},null,8,["modelValue"])]),h("div",Ln,R(u(n)("utm_enable")),1)]),h("div",Nn,[h("div",Rn,[B(l,{modelValue:u(t).article.routeParams.getEnable,"onUpdate:modelValue":a[5]||(a[5]=o=>u(t).article.routeParams.getEnable=o)},null,8,["modelValue"])]),h("div",Vn,[h("div",null,R(u(n)("use_getpatams")),1),u(t).article.routeParams.getEnable?(k(),T("div",Bn,[u(t).article.routeParams.keysArr.length===0?(k(),T("div",Fn,R(u(n)("available_all_params")),1)):(k(),T("div",Kn,R(u(n)("available_selected_params")),1)),h("div",Un,[(k(!0),T(ae,null,me(u(t).article.routeParams.keysArr,(o,d)=>(k(),T("div",{class:"d-table-row",key:d},[h("div",Mn,[Q(h("input",{class:"form-control form-control-sm",type:"text","onUpdate:modelValue":p=>u(t).article.routeParams.keysArr[d]=p},null,8,zn),[[be,u(t).article.routeParams.keysArr[d]]])]),h("div",In,[Q(h("i",{class:"fas fa-arrow-circle-down",onClick:p=>{u(t).article.routeParams.swap=u(t).article.routeParams.keysArr[d+1],u(t).article.routeParams.keysArr[d+1]=u(t).article.routeParams.keysArr[d],u(t).article.routeParams.keysArr[d]=u(t).article.routeParams.swap,delete u(t).article.routeParams.swap}},null,8,Hn),[[Ae,u(t).article.routeParams.keysArr.length-1>d&&u(t).article.routeParams.bindKeys]])]),h("div",Wn,[d>0&&u(t).article.routeParams.bindKeys?(k(),T("i",{key:0,class:"fas fa-arrow-circle-up",onClick:p=>{i.value=u(t).article.routeParams.keysArr[d-1],u(t).article.routeParams.keysArr[d-1]=u(t).article.routeParams.keysArr[d],u(t).article.routeParams.keysArr[d]=i.value}},null,8,jn)):U("",!0)]),h("div",Xn,[h("i",{class:"fas fa-trash",onClick:p=>u(t).article.routeParams.keysArr.splice(d,1)},null,8,Yn)])]))),128))]),h("div",qn,R(u(n)("add_route_params")),1),h("div",Zn,[h("div",Jn,[Q(h("input",{class:"form-control form-control-sm",type:"text","onUpdate:modelValue":a[6]||(a[6]=o=>r.value=o)},null,512),[[be,r.value]])]),h("div",Gn,[r.value.trim()!=""?(k(),T("span",{key:0,class:"fas fa-plus",onClick:a[7]||(a[7]=o=>{u(t).article.routeParams.keysArr.push(r.value),r.value=""})})):(k(),T("span",Qn))])]),u(t).article.routeParams.keysArr.length>0?(k(),T("div",er,[h("div",tr,[B(l,{modelValue:u(t).article.routeParams.bindKeys,"onUpdate:modelValue":a[8]||(a[8]=o=>u(t).article.routeParams.bindKeys=o)},null,8,["modelValue"])]),h("div",nr,[h("div",null,R(u(n)("bind_params")),1)])])):U("",!0)])):U("",!0)])]),h("div",rr,R(u(n)("ready_url_rout")),1),h("div",null,[h("strong",null,[h("span",null,"/"+R(u(t).article.name),1),u(t).article.routeParams.getEnable?(k(),T("span",ar,[u(t).article.routeParams.keysArr.length==0?(k(),T("span",sr,"/name1/value1/.../nameN/valueN")):(k(),T("span",lr,[(k(!0),T(ae,null,me(u(t).article.routeParams.keysArr,o=>(k(),T("span",null,[u(t).article.routeParams.bindKeys?U("",!0):(k(),T("span",or,"/"+R(o),1)),Ke("/value_"+R(o),1)]))),256))]))])):U("",!0),u(t).article.routeParams.utmParamsEnable?(k(),T("span",ir,"?utm_rametrs...")):U("",!0)])])])):U("",!0)]),h("button",{class:"btn btn-sm btn-primary",onClick:a[9]||(a[9]=o=>u(t).saveRec())},R(u(n)("save")),1),h("pre",null,"        "+R(u(t).article)+`
    `,1)]),_:1},8,["visible","header"])}}},dr={class:"list-unstyled m-0"},ur={class:"ms-2"},pr={class:"ms-2"},fr={class:"ms-2"},hr={class:"ms-2"},gr={__name:"Help",setup(e){const t=de(),{t:n}=Fe();return(r,i)=>{const s=se("Dialog");return k(),ce(s,{visible:u(t).statusHelp,"onUpdate:visible":i[0]||(i[0]=a=>u(t).statusHelp=a),header:"Справка",modal:"",class:"w-50"},{default:z(()=>[h("ul",dr,[h("li",null,[i[1]||(i[1]=h("kbd",null,"Ctrl+S",-1)),i[2]||(i[2]=Ke()),h("span",ur,R(u(n)("save")),1)]),h("li",null,[i[3]||(i[3]=h("kbd",null,"Shift_",-1)),h("span",pr,R(u(n)("blade_snippet")),1)]),h("li",null,[i[4]||(i[4]=h("kbd",null,"Alt+1",-1)),h("span",fr,R(u(n)("go_selected")),1)]),h("li",null,[i[5]||(i[5]=h("kbd",null,"Alt+/",-1)),h("span",hr,R(u(n)("blade_comment")),1)])])]),_:1},8,["visible"])}}};function mr(){const e=dt.require("ace/mode/html_highlight_rules").HtmlHighlightRules;if(e.__bladePatched)return;const t=[{token:"comment",regex:/\{\{\-\-[\s\S]*?\-\-\}\}/},{token:"variable",regex:/\{\{[\s\S]*?\}\}/},{token:"entity.name.function",regex:/@[A-Za-z_]\w*/}],n=e.prototype.getRules;e.prototype.getRules=function(){const r=n.call(this);for(const i in r)r[i].unshift(...t);return r},e.__bladePatched=!0}function vr(e){const t=[{tabTrigger:"",name:"_@auth",content:`@auth
	$0
@endauth`},{tabTrigger:"",name:"_@can",content:`@can(\${1:ability})
	$0
@endcan`},{tabTrigger:"",name:"_@cannot",content:`@cannot(\${1:ability})
	$0
@endcannot`},{tabTrigger:"",name:"_@csrf",content:"@csrf"},{tabTrigger:"",name:"_@dd",content:"@dd(${1:var})"},{tabTrigger:"",name:"_@dump",content:"@dump(${1:var})"},{tabTrigger:"",name:"_@else",content:`@else
	$0`},{tabTrigger:"",name:"_@elseif",content:"@elseif ($${1:user}->${2:active})"},{tabTrigger:"",name:"_@empty",content:`@empty ($\${1:arr})
	$0
@endempty`},{tabTrigger:"",name:"_@endauth",content:"@endauth"},{tabTrigger:"",name:"_@endcan",content:"@endcan"},{tabTrigger:"",name:"_@endcannot",content:"@endcannot"},{tabTrigger:"",name:"_@endempty",content:"@endempty"},{tabTrigger:"",name:"_@endforeach",content:"@endforeach"},{tabTrigger:"",name:"_@endif",content:"@endif"},{tabTrigger:"",name:"_@endfor",content:"@endfor"},{tabTrigger:"",name:"_@endguest",content:"@endguest"},{tabTrigger:"",name:"_@endisset",content:"@endisset"},{tabTrigger:"",name:"_@endonce",content:"@endonce"},{tabTrigger:"",name:"_@endprepend",content:"@endprepend"},{tabTrigger:"",name:"_@endphp",content:"@endphp"},{tabTrigger:"",name:"_@endpush",content:"@endpush"},{tabTrigger:"",name:"_@endsection",content:"@endsection"},{tabTrigger:"",name:"_@endswitch",content:"@endswitch"},{tabTrigger:"",name:"_@endwhile",content:"@endwhile"},{tabTrigger:"",name:"_@env",content:`@env(\${1:environment})
	$0
@endenv`},{tabTrigger:"",name:"_@error",content:`@error('\${1:field}')
	<div class="text-danger">{{ $message }}</div>
@enderror`},{tabTrigger:"",name:"_@extends",content:"@extends('${1:layout}')"},{tabTrigger:"",name:"_@for",content:"@for ($${1:i} = 0; $${1:i} < ${2:10}; $${1:i}++)\n	$0\n@endfor"},{tabTrigger:"",name:"_@foreach",content:"@foreach ($${1:items} as $${2:item})\n	$0\n@endforeach"},{tabTrigger:"",name:"_@foreach index",content:"@foreach ($${1:items} as $${2:ndex} => $${3:item})\n	$0\n@endforeach"},{tabTrigger:"",name:"_@guest",content:`@guest
	$0
@endguest`},{tabTrigger:"",name:"_@if",content:`@if ($\${1:var} > 0)
	$0
@endif`},{tabTrigger:"",name:"_@include",content:"@include('magic::${1:view}', [${2:data}])"},{tabTrigger:"",name:"_@includeFirst",content:"@includeFirst(['magic::${1:view1}', 'magic::${2:view2}'])"},{tabTrigger:"",name:"_@includeIf",content:"@includeIf('magic::${1:view}', [${2:data}])"},{tabTrigger:"",name:"_@includeWhen",content:"@includeWhen(${1:condition}, 'magic::${2:view}', [${3:data}])"},{tabTrigger:"",name:"_@includeUnless",content:"@includeUnless(${1:condition}, 'magic::${2:view}', [${3:data}])"},{tabTrigger:"",name:"_@isset",content:`@isset ($\${1:var})
	$0
@endisset`},{tabTrigger:"",name:"_@json",content:"@json(${1:data})"},{tabTrigger:"",name:"_@method",content:"@method('${1:PUT}')"},{tabTrigger:"",name:"_@once",content:`@once
	$0
@endonce`},{tabTrigger:"",name:"_@php",content:`@php
	$0
@endphp`},{tabTrigger:"",name:"_@prepend",content:`@prepend('\${1:stack}')
	$0
@endprepend`},{tabTrigger:"",name:"_@production",content:`@production
	$0
@endproduction`},{tabTrigger:"",name:"_@props",content:"@props(['${1:variable}' => ${2:default}])"},{tabTrigger:"",name:"_@push",content:`@push('\${1:stack}')
	$0
@endpush`},{tabTrigger:"",name:"_@section (block)",content:`@section('\${1:name}')
	$0
@endsection`},{tabTrigger:"",name:"_@section (inline)",content:"@section('${1:name}', '${2:content}')"},{tabTrigger:"",name:"_@stack",content:"@stack('${1:stack}')"},{tabTrigger:"",name:"_@switch",content:`@switch ($\${1:value})
	@case($\${2:key})
		$0
	@break
@endswitch`},{tabTrigger:"",name:"_@unless",content:`@unless ($\${1:cond})
	$0
@endunless`},{tabTrigger:"",name:"_@verbatim",content:`@verbatim
	$0
@endverbatim`},{tabTrigger:"",name:"_@while",content:`@while ($\${1:flag})
	$0
@endwhile`},{tabTrigger:"",name:"_@yield",content:"@yield('${1:section}')"},{tabTrigger:"",name:"_<x-magic",content:'<x-magic::${1:anonymus} :data="$${1:value}"></x-magic::${1:anonymus}>)'}],n=t.map(c=>c.tabTrigger.replace("@",""));ace.require("ace/snippets").snippetManager.register(t,"html");const i=ace.require("ace/autocomplete").Autocomplete,s=i.prototype.showPopup,a=i.prototype.updateCompletions;function l(c){c&&Array.isArray(c.data)&&(c.data=c.data.filter(o=>!n.includes(o.value)),c.setData(c.data))}i.prototype.showPopup=function(c){s.call(this,c),l(this.popup)},i.prototype.updateCompletions=function(c){a.call(this,c),l(this.popup)},e.commands.addCommand({name:"toggleLineMarkersCommand",bindKey:{win:"Alt-/",mac:"Alt-/"},exec:br,readOnly:!1})}function yr(e){let t,n;if(e.getSelectionRange().isEmpty()){const r=e.getCursorPosition();e.selection.selectLine(r.row),t=n=r.row}else{const r=e.getSelectionRange(),i=ace.require("ace/range").Range;t=r.start.row,n=r.end.row;const s=new i(t,0,n,e.session.getLine(n).length);e.selection.setRange(s)}return{startRow:t,endRow:n}}function _r(e){return/{{--.*--}}/.test(e)?(e=e.replace(/^\s*{{--\s?/,""),e=e.replace(/\s?--}}\s*$/,""),e):`{{-- ${e} --}}`}function br(e){const{startRow:t,endRow:n}=yr(e),r=e.session,i=ace.require("ace/range").Range;for(let s=t;s<=n;s++){const a=r.getLine(s),l=_r(a),c=a.length;r.replace(new i(s,0,s,c),l)}}const wr=["id"],Qe={__name:"AceEditor",props:_t({lang:{type:String,default:"html",validator:e=>["html","php","blade"].includes(e)},theme:{type:String,default:"monokai"},readOnly:{type:Boolean,default:!1},tabSize:{type:Number,default:4},wrap:{type:Boolean,default:!1},height:{type:Number,default:100}},{modelValue:{type:String,default:"XXXXXXXX"},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=de(),n=P(bt()),r=e,i=wt(e,"modelValue"),s=P(null);let a=null;const l=()=>r.lang==="php"?"ace/mode/php":"ace/mode/html",c=o=>`ace/theme/${o}`;return Te(()=>{mr(),a=dt.edit(n.value,{value:i.value,mode:l(r.lang),theme:c(r.theme),readOnly:r.readOnly,wrap:r.wrap,tabSize:r.tabSize,useWorker:!1}),a.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableEmmet:!0}),a.setFontSize(14),a.commands.addCommand({name:"sendSelectedToParent",bindKey:{win:"Alt-1",mac:"Alt-1"},exec(o){const d=o.session.getTextRange(o.getSelectionRange());if(d.trim()===""){document.showToast("Статья не выделена");return}t.gotoArticleByName(d)}}),r.lang!=="php"&&vr(a),a.session.on("change",()=>{i.value=a.getValue()}),r.lang==="php"&&W(()=>t.searchTextController,o=>{o.trim()&&(a.find(o),a.execCommand("find"),t.searchTextController="")}),r.lang==="html"&&W(()=>t.searchTextView,o=>{o.trim()&&(a.find(t.searchTextView),a.execCommand("find"),t.searchTextView="")})}),W(i,o=>{if(!a)return;const d=a.getValue();o!==d&&a.setValue(o)}),kt(()=>a?.destroy()),W(()=>r.lang,o=>a?.session.setMode(l())),W(()=>r.theme,o=>a?.setTheme(c(o))),W(()=>r.readOnly,o=>a?.setReadOnly(o)),W(()=>r.tabSize,o=>a?.session.setTabSize(o)),W(()=>r.wrap,o=>a?.session.setUseWrapMode(o)),(o,d)=>(k(),T("div",{style:ee("height: "+e.height+"px; width: 100%; position: relative;")},[h("div",{ref_key:"el",ref:s,id:n.value,style:{width:"100%",height:"100%"}},null,8,wr)],4))}};var kr=!1,$r=!0;function Le(e){return Object.prototype.toString.call(e)==="[object Array]"}function et(e){return Object.prototype.toString.call(e)==="[object Object]"}function xr(e){return typeof e=="function"}function Sr(e,t){return e<t?e:t}function pt(e,t){let n,r=0;for(;(n=e.indexOf(t))>-1;)e.splice(n,1),r++;return r}function ft(e){return e[e.length-1]}function Tr(e){return Le(e)?e:[e]}function Cr(e,t){let n=new Set(t);const r={};return n.forEach(i=>{r[i]=e[i]}),r}function Dr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){if(t.reverse)if(e.length!=null)for(let n=e.length-1;n>=0;n--){const r={value:e[n],index:n};(!t.exclude||!t.exclude(r))&&(yield r)}else if(et(e)){const n=Object.keys(e);n.reverse();for(const r of n){const i={value:e[r],key:r};(!t.exclude||!t.exclude(i))&&(yield i)}}else throw"Unsupported type";else if(e.length!=null)for(let n=0;n<e.length;n++){const r={value:e[n],index:n};(!t.exclude||!t.exclude(r))&&(yield r)}else if(et(e))for(const n of Object.keys(e)){const r={value:e[n],key:n};(!t.exclude||!t.exclude(r))&&(yield r)}else throw"Unsupported type"})()}function Er(e,t,n){e.hasOwnProperty(t)||(e[t]=n)}function ht(e,t){return Object.keys(t).forEach(n=>{Er(e,n,t[n])}),e}function Pr(e){const t={};return Object.keys(e).forEach(n=>{e[n]!==void 0&&(t[n]=e[n])}),t}function te(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n=ht({...n},{childrenKey:"children"});const{childrenKey:r}=n,i=Le(e)?e:[e];class s{}const a=(l,c,o)=>{n.reverse&&(l=l.slice(),l.reverse());const d=l.length;for(let p=0;p<d;p++){const f=l[p],m=n.reverse?d-p-1:p,_=o?[...o,m]:[];n.childFirst&&f[r]!=null&&a(f[r],f,_);const $=t(f,m,c,_);if($===!1)throw new s;if($==="skip children")continue;if($==="skip siblings")break;n.childFirst||f[r]!=null&&a(f[r],f,_)}};try{a(i,null,Le(e)?[]:null)}catch(l){if(!(l instanceof s))throw l}}function Or(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r;return te(e,function(){if(t(...arguments))return r={node:arguments.length<=0?void 0:arguments[0],index:arguments.length<=1?void 0:arguments[1],parent:arguments.length<=2?void 0:arguments[2],path:arguments.length<=3?void 0:arguments[3]},!1},n),r}function Ar(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Or(e,t,n)?.node}function gt(e,t){const n={childrenKey:"children"};t&&Object.assign(n,t);const{childrenKey:r,nodeHandler:i}=n,s=new qe;return s.childrenKey=r,te(e,(a,l,c,o)=>{let d=Object.assign({},a);d[r]&&(d[r]=[]),i&&(d=i(d,{oldNode:a,index:l,parent:c,path:o})),s.set(o,d)},{childrenKey:r}),s.data}class qe{data;childrenKey="children";constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.data=t}get rootChildren(){const{childrenKey:t}=this,{data:n}=this;return Le(n)?n:n[t]}iteratePath(t){var n=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){const{childrenKey:i,rootChildren:s}=n;if(r.reverse){const a=[...n.iteratePath(t,{...r,reverse:!1})];a.reverse();for(const{path:l,node:c}of a)yield{path:l,node:c}}else{let a=[],l=s;for(const c of t){const o=[...a,c],d=l[c];yield{path:o,node:d},a=o,l=d[i]}}})()}getFamily(t){const n=[];for(const{node:r}of this.iteratePath(t))n.push(r);return n}get(t){return ft(this.getFamily(t))}getParentAndIndex(t){const n=t.slice(),r=n.pop();return{parent:this.get(n),index:r,parentPath:n}}getParent(t){return this.getParentAndIndex(t).parent}set(t,n){if(t==null||t.length===0)this.data=n;else{const{childrenKey:r}=this;let{rootChildren:i}=this;const{parent:s,index:a}=this.getParentAndIndex(t);let l;t.length===1?(i||(this.data?this.data[r]=[]:this.data=[]),l=i):(s[r]||(s[r]=[]),l=s[r]),l[a]=n}}delete(t){const{childrenKey:n,rootChildren:r}=this,{parent:i,index:s}=this.getParentAndIndex(t),a=t.length===1?r:i[n],l=a[s];return a.splice(s,1),l}walk(t,n){const{childrenKey:r,data:i}=this;return te(i,t,r,n)}clone(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return gt(this.data),Pr({childrenKey:this.childrenKey,nodeHandler:t.nodeHandler||void 0})}}function tt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return xr(e)?e(...t):e}function Lr(e,t){return function(){let r,i;try{r=e(...arguments)}catch(s){i=s}finally{}if(i)throw i;return r}}function ke(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[];let r;const i={};let s=i;return{action:function(){for(var c=arguments.length,o=new Array(c),d=0;d<c;d++)o[d]=arguments[d];if(o.length===0)return s===i&&(s=e()),s;if(r||(r=new Br),!r.has(o)&&(r.set(o,e(...o)),t.capacity!=null)){n.push(o);const p=n.splice(0,n.length-t.capacity);for(const f of p)r.delete(f)}return r.get(o)},clearCache:()=>{r=null,n.splice(0,n.length)}}}function Nr(){let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}}function Rr(e,t){for(;;){if(e.parentNode==null)return!1;if(e.parentNode===t)return!0;e=e.parentNode}}function Me(e){let t=e.getBoundingClientRect();if(document.documentElement.clientTop>0){const n=t.top-document.documentElement.clientTop,r=t.bottom,i=t.left-document.documentElement.clientLeft,s=t.right,a=t.width||s-i,l=t.height||r-n,d={top:n,right:s,bottom:r,left:i,width:a,height:l,x:i,y:n};t={...d,toJSON:()=>d}}return t}function nt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n&&n.withSelf?e:e.parentElement;for(;r;){const i=n.until&&r===n.until;if(i&&!n.withUntil)return;const s=t(r);if(s==="break")return;if(s)return r;if(i)return;r=r.parentElement}}function Ne(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}function rt(e,t){for(const n of t)if(Ne(e,n))return!0;return!1}function ne(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent(`on${t}`,n,r)}function re(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent(`on${t}`,n,r)}function Vr(e){let t=[];const n=()=>{if(!i.listening){for(const s of e){ne.apply(this,s);const a=()=>re.apply(this,s);t.push(a)}i.listening=!0}},i={listening:!1,stop:()=>{if(i.listening){for(const s of t)s();t=[],i.listening=!1}},resume:n,start:n};return i.start(),i}function Re(e,t){return getComputedStyle(e)[t]}function Ze(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n={start:0,end:e.length-1,maxTimes:1e3,...n};let{start:r,end:i}=n;const{returnNearestIfNoHit:s,maxTimes:a}=n;let l,c;r==null&&(r=0,i=e.length-1);let o=0,d;for(;r>=0&&r<=i;){if(o>=a)throw Error(`binarySearch: loop times is over ${a}, you can increase the limit.`);l=Math.floor((i-r)/2+r),c=e[l];const p=o+1;if(d=t(c,l,p),d>0)i=l-1;else if(d<0)r=l+1;else return{index:l,value:c,count:p,hit:!0};o++}return s?{index:l,value:c,count:o+1,hit:!1,greater:d>0}:null}class Br{_map=new Map;_values={};_objCount=0;_keysToString(t){const{_map:n}=this;let r=[];for(const i of t){if(!n.has(i))return null;r.push(n.get(i)[0])}return r.toString()}has(t){return this._keysToString(t)!=null}get(t){const{_values:n}=this,r=this._keysToString(t);if(r==null)throw"Value not found by specified keys";return n[r][1]}set(t,n){const{_map:r,_values:i}=this;let s=[];for(const a of t){let l,c=1;r.has(a)?([l,c]=r.get(a),c++):(this._objCount++,l=this._objCount.toString()),r.set(a,[l,c]),s.push(l)}i[s.toString()]=[t.slice(),n]}delete(t){const{_values:n,_map:r}=this,i=this._keysToString(t);if(i==null)throw"Value not found by specified keys";delete n[i];for(const s of t){let[a,l]=r.get(s);l--,l===0?r.delete(s):r.set(s,[a,l])}}clear(){this._map.clear(),this._values={}}*entries(){const{_values:t}=this;for(const n in t){const[r,i]=t[n];yield[r,i]}}count(){return[...this.entries()].length}}const Fr=we({props:{table:Boolean}}),mt=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n},Kr={key:0},Ur={key:1};function Mr(e,t,n,r,i,s){return e.table?(k(),T("table",Kr,[I(e.$slots,"prepend"),h("tbody",null,[I(e.$slots,"default")]),I(e.$slots,"append")])):(k(),T("div",Ur,[I(e.$slots,"prepend"),I(e.$slots,"default"),I(e.$slots,"append")]))}const zr=mt(Fr,[["render",Mr]]),Ir=we({components:{VirtualListTable:zr},props:{items:Array,disabled:Boolean,horizontal:Boolean,firstRender:{type:Number,default:10},buffer:{type:Number,default:100},itemKey:{type:[String,Function]},itemSize:{type:Function},table:Boolean},setup(e){const t=P(0),n=P(e.firstRender-1),r=H(()=>{var g;return Sr(n.value,(((g=e.items)==null?void 0:g.length)||1)-1)}),i=P(0),s=H(()=>f.value[t.value]?F(t.value):0),a=H(()=>f.value.length>0?F(f.value.length-1)+ft(p.value):0),l=H(()=>f.value[r.value]?a.value-F(r.value)-p.value[r.value]:0),c=H(()=>e.disabled?{}:{overflow:"auto"}),o=H(()=>{const g={display:"flex"};return e.disabled||(e.horizontal?Object.assign(g,{"margin-left":s.value+"px","margin-right":l.value+"px",width:a.value-l.value-s.value+"px"}):Object.assign(g,{"margin-top":s.value+"px","margin-bottom":l.value+"px"})),g["flex-direction"]=e.horizontal?"row":"column",e.table&&(delete g.display,delete g["flex-direction"]),g}),d=H(()=>Se((e.items||[]).map(()=>null))),p=H(()=>(e.items||[]).map((g,v)=>{var w;if(d[v]!=null)return d[v];let K=(w=e.itemSize)==null?void 0:w.call(e,g,v);return K==null&&(K=i.value),K})),f=H(()=>{const g=[];return p.value.reduce((v,w)=>(g.push(v),v+w),0),g});W(()=>e.items,y);const m=H(()=>{if(!e.items||e.disabled)return;const g=[];for(let v=t.value;v<=r.value;v++){const w=e.items[v];if(!w)break;g.push({item:w,index:v})}return g}),_=P(),$=P();Te(async()=>{y();try{j()}catch{await Ue(),y()}});let D;function A(){const g=_.value;if(!g)return;const v=x(g);D!=null&&e.buffer-Math.abs(v-D)>=10||(D=v,y())}let V=!1,M=!1;async function y(){var g;if(V){M=!0;return}if(!e.items||e.disabled)return;V=!0;const v=_.value,w=(g=$.value)==null?void 0:g.$el;if(!v||!w)return;i.value||(i.value=De()),t.value=ye(),n.value=Ce(),await Ue();let K,q=0;const X={},le=e.table?w.querySelector("tbody").children:w.children;for(let L=0;L<le.length;L++){const N=le[L],Y=Re(N,"position");if(Y&&["absolute","fixed"].includes(Y))continue;const oe=Re(N,"display")!=="none"?E(N):0,fe=N.getAttribute("vt-index"),Ee=fe?parseInt(fe):t.value+q;X[Ee]=(X[Ee]||0)+oe,q++}for(const L of Object.keys(X)){const N=parseInt(L);d.value[N]!==X[N]&&(d.value[N]=X[N],K=!0)}K&&await Ue(),V=!1,M&&(M=!1,y());function ye(){const L=x(v)-O(v)-e.buffer;return Ze(f.value,N=>N-L,{returnNearestIfNoHit:!0}).index}function Ce(){const L=x(v)-O(v)+S(v)+e.buffer;return Ze(f.value,N=>N-L,{returnNearestIfNoHit:!0}).index}function De(){const L=[],N=e.table?w.querySelector("tbody").children:w.children;for(let Y=0;Y<N.length;Y++){const oe=N[Y],fe=getComputedStyle(oe);if(["absolute","fixed"].includes(fe.position))continue;const Ee=E(oe);if(L.push(Ee),L.length>=10)break}return L.length===0?0:L.reduce((Y,oe)=>Y+oe,0)/L.length}}function S(g){const v=getComputedStyle(g);let w=parseFloat(e.horizontal?v.width:v.height);return v.boxSizing==="border-box"&&(e.horizontal?w=w-parseFloat(v.borderLeftWidth)-parseFloat(v.borderRightWidth):w=w-parseFloat(v.borderTopWidth)-parseFloat(v.borderBottomWidth)),w}function E(g){let v=S(g);const w=getComputedStyle(g);return e.horizontal?v+=parseFloat(w.borderLeftWidth)+parseFloat(w.borderRightWidth)+parseFloat(w.marginLeft)+parseFloat(w.marginRight):v+=parseFloat(w.borderTopWidth)+parseFloat(w.borderBottomWidth)+parseFloat(w.marginTop)+parseFloat(w.marginBottom),v=Number.isNaN(v)?0:v,v}function x(g){return e.horizontal?g.scrollLeft:g.scrollTop}function O(g){const v=getComputedStyle(g);return e.horizontal?parseFloat(v.paddingLeft):parseFloat(v.paddingTop)}function F(g){return f.value[g]}function j(){const g=_.value;new ResizeObserver(v=>{for(let w of v)if(Ne(w.target,"vtlist")){y();break}}).observe(g)}function ue(g,v){if(e.itemKey){if(typeof e.itemKey=="string"&&e.itemKey==="index")return v;if(typeof e.itemKey=="function")return e.itemKey(g,v)}}return{listElRef:_,listInnerRef:$,onscroll:A,listStyle:c,listInnerStyle:o,visibleItemsInfo:m,getItemKey:ue,update:y,sizes:p,positions:f,runtimeSizes:d}}});function Hr(e,t,n,r,i,s){const a=se("VirtualListTable");return k(),T("div",{class:"vtlist",ref:"listElRef",style:ee(e.listStyle),onScrollPassive:t[0]||(t[0]=(...l)=>e.onscroll&&e.onscroll(...l))},[B(a,{class:"vtlist-inner",ref:"listInnerRef",style:ee(e.listInnerStyle),table:e.table},{prepend:z(()=>[I(e.$slots,"prepend")]),append:z(()=>[I(e.$slots,"append")]),default:z(()=>[e.disabled?(k(!0),T(ae,{key:0},me(e.items,(l,c)=>I(e.$slots,"default",{key:e.getItemKey(l,c),item:l,index:c})),128)):(k(!0),T(ae,{key:1},me(e.visibleItemsInfo,({item:l,index:c})=>I(e.$slots,"default",{key:e.getItemKey(l,c),item:l,index:c})),128))]),_:3},8,["style","table"])],36)}const Wr=mt(Ir,[["render",Hr]]);const ge="children";function jr(e){const n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r={...Xr,...n,data:e,stats:null,statsFlat:null,_statsMap:null,initialized:!1,init(){const{data:s,childrenKey:a}=this,l=new qe([]);this._statsMap=new Map,te(s,(o,d,p,f)=>{const m=this.statHandler({...at(),data:o,open:!!this.defaultOpen,parent:l.getParent(f),children:[],level:f.length});this._statsMap.set(o,m),l.set(f,m)},{childrenKey:a});const c=[];l.walk(o=>{c.push(o)}),this.stats=this.statsHandler(l.rootChildren),this.statsFlat=this.statsFlatHandler(c),this.initialized=!0},getStat(s){let a=this._statsMap.get(s);if(!a)throw new st("Stat not found");return a},has(s){if(s.isStat)return this.statsFlat.indexOf(s)>-1;try{return!!this.getStat(s)}catch(a){if(a instanceof st)return!1;throw a}},_getPathByStat(s){if(s==null)return[];const l=this.getSiblings(s).indexOf(s);return[...s.parent?this._getPathByStat(s.parent):[],l]},afterOneCheckChanged(s){const{checked:a}=s;if(s._ignoreCheckedOnce)return delete s._ignoreCheckedOnce,!1;const l=c=>{const{parent:o}=c;if(o){let d,p,f;for(const _ of o.children)_.checked?d=!0:_.checked===0?f=!0:p=!0;const m=f?0:p?d?0:!1:!0;o.checked!==m&&(this._ignoreCheckedOnce(o),o.checked=m),l(o)}};return l(s),te(s.children,c=>{c.checked!==a&&(this._ignoreCheckedOnce(c),c.checked=a)},{childrenKey:ge}),!0},_ignoreCheckedOnce(s){s._ignoreCheckedOnce=!0,setTimeout(()=>{s._ignoreCheckedOnce&&(s._ignoreCheckedOnce=!1)},100)},isVisible(s){const a=s.isStat?s:this.getStat(s),l=c=>!c||!c.hidden&&c.open&&l(c.parent);return!!(!a.hidden&&l(a.parent))},updateCheck(){te(this.stats,s=>{if(s.children&&s.children.length>0){const a=s.children.every(o=>o.checked===!0),l=s.children.every(o=>o.checked===!1),c=a?!0:l?!1:0;s.checked!==c&&(this._ignoreCheckedOnce(s),s.checked=c)}},{childFirst:!0,childrenKey:ge})},getChecked(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.statsFlat.filter(a=>a.checked||s&&a.checked===0)},getUnchecked(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this.statsFlat.filter(a=>s?!a.checked:a.checked===!1)},openAll(){for(const s of this.statsFlat)s.open=!0},closeAll(){for(const s of this.statsFlat)s.open=!1},openNodeAndParents(s){const a=s.isStat?s:this.getStat(s);for(const l of this.iterateParent(a,{withSelf:!0}))l.open=!0},_calcFlatIndex(s,a){let l=s?this.statsFlat.indexOf(s)+1:0;const c=s?s.children:this.stats;for(let o=0;o<a;o++)l+=this._count(c[o]);return l},add(s,a,l){if(this.has(s))throw"Can't add because data exists in tree";const c=a?a.children:this.stats;l==null&&(l=c.length);const o=this.statHandler({...at(),open:!!this.defaultOpen,data:s,parent:a||null,children:[],level:a?a.level+1:1});this._setPosition(o,a||null,l);const d=s[this.childrenKey];if(d){const p=d.slice();for(const f of p)this.add(f,o)}},remove(s){const a=this.getSiblings(s);if(a.includes(s)){pt(a,s);const l=this._flat(s);this.statsFlat.splice(this.statsFlat.indexOf(s),l.length);for(const c of l)this._statsMap.delete(c.data);return this.afterRemoveStat(s),!0}return!1},getSiblings(s){const{parent:a}=s;return a?a.children:this.stats},_setPosition(s,a,l){(a?a.children:this.stats).splice(l,0,s),s.parent=a,s.level=a?a.level+1:1;const o=this._calcFlatIndex(a,l),d=this._flat(s);this.statsFlat.splice(o,0,...d);for(const p of d)this._statsMap.has(p.data)||this._statsMap.set(p.data,p);te(s,(p,f,m)=>{m&&(p.level=m.level+1)},{childrenKey:ge}),this.afterSetStat(s,a,l)},*iterateParent(s,a){let l=a!=null&&a.withSelf?s:s.parent;for(;l;)yield l,l=l.parent},move(s,a,l){if(this.has(s)){if(s.parent===a&&this.getSiblings(s).indexOf(s)===l)return!1;if(s===a)throw new Error("Can't move node to it self");if(a&&s.level<a.level){let c;for(const o of this.iterateParent(a))if(o.level===s.level){c=o;break}if(s===c)throw new Error("Can't move node to its descendant")}this.remove(s)}return this._setPosition(s,a,l),!0},_flat(s){const a=[];return te(s,l=>{a.push(l)},{childrenKey:ge}),a},_count(s){return this._flat(s).length},getData(s,a){const{childrenKey:l}=this,c=new qe([]);return c.childrenKey=l,te(a||this.stats,(o,d,p,f)=>{let m={...o.data,[l]:[]};s&&(m=s(m)),c.set(f,m)},{childrenKey:ge}),c.data}},i=r;return r.noInitialization||i.init(),i}const Xr={childrenKey:"children",defaultOpen:!1,statsHandler(e){return e},statsFlatHandler(e){return e},afterSetStat(e,t,n){},afterRemoveStat(e){},statHandler(e){return e}};function at(){return{isStat:!0,hidden:!1,checked:!1,style:null,class:null,draggable:null,droppable:null}}class st extends Error{constructor(t){super(t),this.name="StatNotFoundError"}}const Pe={start:["mousedown","touchstart"],move:["mousemove","touchmove"],end:["mouseup","touchend"]},ze={isTouch(e){return e.type&&e.type.startsWith("touch")},_getStore(e){return e._wrapperStore||(e._wrapperStore=[]),e._wrapperStore},on(e,t,n,r){const{args:i,mouseArgs:s,touchArgs:a}=lt(r),l=this._getStore(e),c=this,o=function(d){let p;if(c.isTouch(d))p={x:d.changedTouches[0].pageX,y:d.changedTouches[0].pageY,pageX:d.changedTouches[0].pageX,pageY:d.changedTouches[0].pageY,clientX:d.changedTouches[0].clientX,clientY:d.changedTouches[0].clientY,screenX:d.changedTouches[0].screenX,screenY:d.changedTouches[0].screenY};else if(p={x:d.pageX,y:d.pageY,pageX:d.pageX,pageY:d.pageY,clientX:d.clientX,clientY:d.clientY,screenX:d.screenX,screenY:d.screenY},t==="start"&&d.which!==1)return;return n.call(this,d,p)};l.push({handler:n,wrapper:o}),ne.call(null,e,Pe[t][0],o,...i,...s),ne.call(null,e,Pe[t][1],o,...i,...a)},off(e,t,n,r){const{args:i,mouseArgs:s}=lt(r),a=this._getStore(e);for(let l=a.length-1;l>=0;l--){const{handler:c,wrapper:o}=a[l];n===c&&(re.call(null,e,Pe[t][0],o,...i,...s),re.call(null,e,Pe[t][1],o,...i,...s),a.splice(l,1))}}};function lt(e){e||(e={});const t=e.args||[],n=e.mouseArgs||[],r=e.touchArgs||[];return{args:t,mouseArgs:n,touchArgs:r}}const Ie=new Map,ie={triggerElement:null,dragElement:null,internal:!1,dropEffect:"none",preventDefault:!1},G=ie;function $e(e){e.dataTransfer&&(e.dataTransfer.dropEffect=G.dropEffect)}function Yr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ie.has(e))throw"Already registered on specified element";const n={...t},r=n;ht(n,qr),ze.on(e,"start",i,{touchArgs:[{passive:!0}]}),ze.on(e,"end",s);function i(p){var f;const m=p.target;m.nodeType===Node.ELEMENT_NODE&&(G.triggerElement=m);const _=m;if(n.ingoreHTMLTags&&_.tagName&&n.ingoreHTMLTags.find(D=>D.toUpperCase()===_.tagName))return;const $=(f=n.beforeDragStart)===null||f===void 0?void 0:f.call(n,p);$&&($.setAttribute("draggable","true"),G.dragElement=$)}function s(p){G.dragElement&&G.dragElement.removeAttribute("draggable")}function a(p){var f;G.internal=!0,(f=n.onDragStart)===null||f===void 0||f.call(n,p),$e(p)}function l(p){var f;(f=n.onDrag)===null||f===void 0||f.call(n,p),$e(p)}function c(p){var f;(f=n.onDragEnd)===null||f===void 0||f.call(n,p),G.internal=!1,G.dragElement&&G.dragElement.removeAttribute("draggable"),G.triggerElement=null,G.dragElement=null,G.dropEffect="none"}const o=Jr(e,{onDragLeave(p){var f;(f=n.onDragLeave)===null||f===void 0||f.call(n,p),$e(p)},onDragEnter(p){var f;r.ifPreventDefault(p)&&p.preventDefault(),(f=n.onDragEnter)===null||f===void 0||f.call(n,p),$e(p)},onDragOver(p){var f;r.ifPreventDefault(p)&&p.preventDefault(),(f=n.onDragOver)===null||f===void 0||f.call(n,p),$e(p)},onDrop(p){var f;r.ifPreventDefault(p)&&p.preventDefault(),(f=n.onDrop)===null||f===void 0||f.call(n,p)},onEnter(p){var f;(f=n.onEnter)===null||f===void 0||f.call(n,p)},onLeave(p){var f;(f=n.onLeave)===null||f===void 0||f.call(n,p)}});return ne(e,"dragstart",a),ne(e,"drag",l),ne(e,"dragend",c),Object.assign(n,{root:e,destroy:()=>{ze.off(e,"start",i,{touchArgs:[{passive:!0}]}),re(e,"dragstart",a),re(e,"drag",l),re(e,"dragend",c),o(),Ie.delete(e)}}),Ie.set(e,r),r}const qr={ingoreHTMLTags:["INPUT","TEXTAREA","SELECT","OPTGROUP","OPTION"],ifPreventDefault(e){return ie.dragElement?!0:G.preventDefault},beforeDragStart(e){},onDragStart(e){},onDrag(e){},onDragEnter(e){},onDragLeave(e){},onDragOver(e){},onDragEnd(e){},onDrop(e){}};let Ve=null;const Zr=e=>{Ve=e,setTimeout(()=>{Ve=null},20)};function Jr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e;let r=!1;const i=m=>{var _;r=!0,(_=t.onEnter)===null||_===void 0||_.call(t,m),d.resume()},s=m=>{var _;Zr(m.target),(_=t.onDragEnter)===null||_===void 0||_.call(t,m),r||i(m)},a=m=>{var _;r||i(m),(_=t.onDragOver)===null||_===void 0||_.call(t,m)},l=m=>{var _;(_=t.onDragLeave)===null||_===void 0||_.call(t,m);const $=function(){var A;let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m;r=!1,(A=t.onLeave)===null||A===void 0||A.call(t,V),d.stop()},D=Ve;Ve=null,D&&Rr(D,n)||$()},c=m=>{var _;(_=t.onDrop)===null||_===void 0||_.call(t,m)},o=m=>{var _;m instanceof KeyboardEvent&&m.key!=="Escape"||(r=!1,d.stop(),(_=t.onEndBeforeLeave)===null||_===void 0||_.call(t,m))},d=Vr([[e,"drop",o],[window,"mouseup",o],[window,"touchend",o],[window,"keydown",o]]);d.stop();const p=()=>{ne(e,"dragenter",s),ne(e,"dragover",a),ne(e,"dragleave",l),ne(e,"drop",c)},f=()=>{re(e,"dragenter",s),re(e,"dragover",a),re(e,"dragleave",l),re(e,"drop",c),d.stop()};return p(),f}let Be=!1;const Gr=()=>{Be=!0,setTimeout(()=>{Be=!1},100)},Qr=we({props:["stat","rtl","btt","indent","table","treeLine","treeLineOffset","processor"],emits:["open","close","check"],setup(e,{emit:t}){const n=H(()=>({[e.rtl?"paddingRight":"paddingLeft"]:e.indent*(e.stat.level-1)+"px"}));W(()=>e.stat.checked,s=>{Be||e.processor.afterOneCheckChanged(e.stat)&&t("check",e.stat)}),W(()=>e.stat.open,s=>{Be||(t(s?"open":"close",e.stat),Gr())});const r=H(()=>{const s=[],a=d=>{var p;if(d.parent){let f=(p=d.parent)==null?void 0:p.children.indexOf(d);do{f++;let m=d.parent.children[f];if(m){if(!m.hidden)return!0}else break}while(!0)}return!1},l=e.rtl?"right":"left",c=e.btt?"top":"bottom";let o=e.stat;for(;o;){let d=(o.level-2)*e.indent+e.treeLineOffset;const p=a(o),f=()=>{s.push({style:{[l]:d+"px",[c]:p?0:"50%"}})};o===e.stat?o.level>1&&f():p&&f(),o=o.parent}return s}),i=H(()=>{let s=(e.stat.level-2)*e.indent+e.treeLineOffset;return{[e.rtl?"right":"left"]:s+"px"}});return{indentStyle:n,vLines:r,hLineStyle:i}}}),Je=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n},ea={class:"tree-node-inner"},ta={key:1,class:"tree-node",ref:"el"};function na(e,t,n,r,i,s){return e.table?(k(),T("tr",ta,[I(e.$slots,"default",{indentStyle:e.indentStyle})],512)):(k(),T("div",{key:0,class:pe(["tree-node",{"tree-node--with-tree-line":e.treeLine}]),style:ee(e.indentStyle),ref:"el"},[e.treeLine?(k(),T(ae,{key:0},[(k(!0),T(ae,null,me(e.vLines,a=>(k(),T("div",{class:"tree-line tree-vline",style:ee(a.style)},null,4))),256)),e.stat.level>1?(k(),T("div",{key:0,class:"tree-line tree-hline",style:ee(e.hLineStyle)},null,4)):U("",!0)],64)):U("",!0),h("div",ea,[I(e.$slots,"default",{indentStyle:e.indentStyle})])],6))}const ra=Je(Qr,[["render",na]]);function aa(e,t={}){const n={...t,statHandler(r){return this._statHandler2&&(r=this._statHandler2(r)),He(t.statHandler,Se(r))},statsHandler(r){return He(t.statsHandler,Se(r))},statsFlatHandler(r){return He(t.statsFlatHandler,Se(r))}};return jr(e,n)}function He(e,t){return e?e(t):t}const sa=we({components:{VirtualList:Wr,TreeNode:ra},props:{value:{required:kr,type:Array},modelValue:{required:$r,type:Array},updateBehavior:{type:String,default:"modify"},processor:{type:Object,default:()=>aa([],{noInitialization:!0})},childrenKey:{type:String,default:"children"},textKey:{type:String,default:"text"},indent:{type:Number,default:20},virtualization:{type:Boolean,default:!1},virtualizationPrerenderCount:{type:Number,default:20},defaultOpen:{type:Boolean,default:!0},statHandler:{type:Function},rtl:{type:Boolean,default:!1},btt:{type:Boolean,default:!1},table:{type:Boolean,default:!1},watermark:{type:Boolean,default:!1},nodeKey:{type:[String,Function],default:"index"},treeLine:{type:Boolean,default:!1},treeLineOffset:{type:Number,default:8}},emits:["update:modelValue","click:node","open:node","close:node","check:node","beforeDragStart","before-drag-start","after-drop","change","enter","leave"],data(){return{stats:[],statsFlat:[],dragNode:null,dragOvering:!1,placeholderData:{},placeholderColspan:1,batchUpdateWaiting:!1,self:this,_ignoreValueChangeOnce:!1}},computed:{valueComputed(){return this.modelValue||[]},visibleStats(){const{statsFlat:e,isVisible:t}=this;let n=e;return this.btt&&(n=n.slice(),n.reverse()),n.filter(r=>t(r))},rootChildren(){return this.stats}},methods:{_emitValue(e){this.$emit("update:modelValue",e)},_updateValue(e){return this.updateBehavior==="disabled"?!1:(e!==this.valueComputed&&(this._ignoreValueChangeOnce=!0),this._emitValue(e),!0)},getStat:We(J("getStat")),has:We(J("has")),updateCheck:J("updateCheck"),getChecked:J("getChecked"),getUnchecked:J("getUnchecked"),openAll:J("openAll"),closeAll:J("closeAll"),openNodeAndParents:J("openNodeAndParents"),isVisible:J("isVisible"),move:ot("move"),add:We(ot("add")),addMulti(e,t,n){this.batchUpdate(()=>{let r=n;for(const i of e)this.add(i,t,r),r!=null&&r++})},remove:J("remove"),removeMulti(e){let t=[...e];this.batchUpdate(()=>{for(const n of t)this.remove(n)})},iterateParent:J("iterateParent"),getSiblings:J("getSiblings"),getData:J("getData"),getRootEl(){return this.$refs.vtlist.listElRef},batchUpdate(e){const t=this.ignoreUpdate(e);return this.batchUpdateWaiting||this._updateValue(this.updateBehavior==="new"?this.getData():this.valueComputed),t},ignoreUpdate(e){const t=this.batchUpdateWaiting;this.batchUpdateWaiting=!0;const n=e();return this.batchUpdateWaiting=t,n}},watch:{processor:{immediate:!0,handler(e){if(e){const t=n=>{if(n){const{childrenKey:r}=this;return n[r]||(n[r]=[]),n[r]}else return this.valueComputed};e._statHandler2=this.statHandler?n=>n.data===this.placeholderData?n:this.statHandler(n):null,e.afterSetStat=(n,r,i)=>{const{childrenKey:s,updateBehavior:a}=this;let l=this.valueComputed;if(a==="new"){if(this.batchUpdateWaiting)return;l=this.getData()}else if(a==="modify"){const c=t(r?.data);c.includes(n.data)||c.splice(i,0,n.data)}this.batchUpdateWaiting||this._updateValue(l)},e.afterRemoveStat=n=>{var r;const{childrenKey:i,updateBehavior:s}=this;let a=this.valueComputed;if(s==="new"){if(this.batchUpdateWaiting)return;a=this.getData()}else if(s==="modify"){const l=t((r=n.parent)==null?void 0:r.data);pt(l,n.data)}this.batchUpdateWaiting||this._updateValue(a)}}e.initialized||(e.data=this.valueComputed,Object.assign(e,Cr(this,["childrenKey","defaultOpen"])),e.init(),e.updateCheck()),this.stats=e.stats,this.statsFlat=e.statsFlat,e.data!==this.valueComputed&&this._updateValue(e.data)}},valueComputed:{handler(e){if(this.dragOvering||this.dragNode||this._ignoreValueChangeOnce)this._ignoreValueChangeOnce=!1;else{const{processor:t}=this;t.data=e,t.init(),this.stats=t.stats,this.statsFlat=t.statsFlat}}}},created(){},mounted(){typeof window<"u"&&(this.watermark===!1&&(window._heTreeWatermarkDisabled=!0),this.watermark&&!window._heTreeWatermarkDisabled&&(window._heTreeWatermark||(window._heTreeWatermark=!0,console.log("%c[he-tree] Vue tree component:  https://hetree.phphe.com","color:#0075ff; font-size:14px;"))))}});function J(e){return function(...t){return this.processor[e](...t)}}function ot(e){return function(...t){return this.batchUpdate(()=>this.processor[e](...t))}}function We(e){return function(t,...n){return t&&(t=Se(t)),e.call(this,t,...n)}}const la={key:0,class:"drag-placeholder he-tree-drag-placeholder"},oa=["colspan"],ia={class:"drag-placeholder he-tree-drag-placeholder"};function ca(e,t,n,r,i,s){const a=se("TreeNode"),l=se("VirtualList");return k(),ce(l,{class:pe(["he-tree",{"he-tree--rtl rtl":e.rtl,"he-tree--drag-overing drag-overing":e.dragOvering}]),ref:"vtlist",items:e.visibleStats,disabled:!e.virtualization,table:e.table,itemKey:e.nodeKey},{prepend:z(()=>[I(e.$slots,"prepend",{tree:e.self})]),default:z(({item:c,index:o})=>[B(a,{"vt-index":o,class:pe([c.class,{"drag-placeholder-wrapper":c.data===e.placeholderData,"dragging-node":c===e.dragNode}]),style:ee(c.style),stat:c,rtl:e.rtl,btt:e.btt,indent:e.indent,table:e.table,treeLine:e.treeLine,treeLineOffset:e.treeLineOffset,processor:e.processor,onClick:d=>e.$emit("click:node",c),onOpen:t[0]||(t[0]=d=>e.$emit("open:node",d)),onClose:t[1]||(t[1]=d=>e.$emit("close:node",d)),onCheck:t[2]||(t[2]=d=>e.$emit("check:node",d))},{default:z(({indentStyle:d})=>[c.data===e.placeholderData?(k(),T(ae,{key:0},[e.table?(k(),T("td",{key:1,style:ee(d),colspan:e.placeholderColspan},[h("div",ia,[I(e.$slots,"placeholder",{tree:e.self})])],12,oa)):(k(),T("div",la,[I(e.$slots,"placeholder",{tree:e.self})]))],64)):I(e.$slots,"default",{key:1,node:c.data,stat:c,indentStyle:d,tree:e.self},()=>[Ke(R(c.data[e.textKey]),1)])]),_:2},1032,["vt-index","class","style","stat","rtl","btt","indent","table","treeLine","treeLineOffset","processor","onClick"])]),append:z(()=>[I(e.$slots,"append",{tree:e.self})]),_:3},8,["class","items","disabled","table","itemKey"])}const da=Je(sa,[["render",ca]]);let C=null,b=null,je,xe,he,Oe,Xe,Z,it;const Ye={get targetInfo(){return xe},get dragNode(){return Z},get targetTree(){return b}},ua=we({extends:da,props:{triggerClass:{type:[String,Array]},disableDrag:Boolean,disableDrop:Boolean,eachDraggable:{type:Function},eachDroppable:{type:Function},rootDroppable:{type:[Boolean,Function],default:!0},dragOpen:{type:Boolean,default:!0},dragOpenDelay:{type:Number,default:0},beforeDragOpen:{type:Function},resolveStartMovePoint:{type:[String,Function]},keepPlaceholder:{type:Boolean},maxLevel:{type:Number},dragCopy:{type:Boolean},dragCopyDataHandler:{type:Function},onExternalDragOver:{type:Function},externalDataHandler:{type:Function},ondragstart:{type:Function},dragOverThrottleInterval:{type:Number,default:0}},data(){return{treeDraggableInstance:null}},computed:{},methods:{getNodeByElement(e){const t=e.getAttribute("vt-index");return t==null?null:this.visibleStats[t]},isDraggable(e){if(this.disableDrag)return!1;if(e.draggable!=null)return e.draggable;if(this.eachDraggable){const n=this.eachDraggable(e);if(n!=null)return n}const{parent:t}=e;return t?this.isDraggable(t):!0},isDroppable(e){if(this.disableDrop)return!1;if(!e)return tt(this.rootDroppable,[this,C]);if(e.droppable!=null)return e.droppable;if(this.eachDroppable){const n=this.eachDroppable(e);if(n!=null)return n}const{parent:t}=e;return t?this.isDroppable(t):!0},_eachDroppable(){var e;return tt((e=this._isDragCopy)==null?void 0:e.call(this),[this])}},mounted(){const e=(o,d)=>{let p=!0;return C&&C!==this&&(p=p&&this._isMoved),this.table&&!this._isDragCopy&&(p=p&&this._isDragCopy),p&&(o.x!==d.x||o.y!==d.y)},t=(o,d)=>{b.ignoreUpdate(()=>{if(!b.has(b.placeholderData)){if(b.table){let f=0;const m=b.getRootEl().querySelector("tr");if(m)for(const{value:_}of Dr(m.children))Re(_,"display")!=="none"&&(f+=_.colSpan||1);f<1&&(f=1),b.placeholderColspan=f}b.add(b.placeholderData)}const p=b.getStat(b.placeholderData);b.move(p,o,d)})},n=()=>{const o=this;if(o.has(o.placeholderData))return o.remove(o.getStat(o.placeholderData)),!0},r=o=>{o?ie.dropEffect=C!=null&&C.dragCopy?"copy":"move":ie.dropEffect="none"},i=o=>{const d=this;o?r(!0):d.keepPlaceholder?d.has(d.placeholderData)||r(!1):(n(),r(!1))};let s={x:0,y:0};const a=this.getRootEl();let l=null;const c=()=>{b!=null&&b.has(b.placeholderData)&&b.ignoreUpdate(()=>{b.remove(b.getStat(b.placeholderData)),C&&(C.dragNode.hidden=!1,C.dragOvering=!1)})};this.treeDraggableInstance=Yr(a,{beforeDragStart:o=>{if(!ie.triggerElement)return;let d=this.triggerClass;(!d||d.length===0)&&(d="tree-node");let p=Tr(d),f=nt(ie.triggerElement,m=>{if(rt(m,p))return!0;if(Ne(m,"tree-node"))return"break"},{withSelf:!0,until:a});if(l=nt(f,m=>{if(Ne(m,"tree-node"))return!0},{withSelf:!0,until:a}),!!l){if(Z=this.getNodeByElement(l),!Z)throw"Can't find drag node";if(this.isDraggable(Z))return this.$emit("before-drag-start",Z),this.$emit("beforeDragStart",Z),a}},onDragStart:o=>{var d,p,f;if(!l||!Z)return;{const{x:$,y:D}=l.getBoundingClientRect(),{clientX:A,clientY:V}=o;(d=o.dataTransfer)==null||d.setDragImage(l,A-$,V-D)}Xe={x:o.clientX,y:o.clientY},C=this,C.dragNode=Z,Oe=(()=>{if(this.resolveStartMovePoint==="mouse")return{x:o.clientX,y:o.clientY};if(typeof this.resolveStartMovePoint=="function")return this.resolveStartMovePoint(l);{let $,D=0;if(this.table){let A=l.getBoundingClientRect();$={x:A.x,y:A.y},this.rtl&&($.x=A.right),D=A.height}else if(!this.rtl)$=l.children[0].getBoundingClientRect().toJSON(),D=$.height;else{const A=l.children[0].getBoundingClientRect();$={x:A.right,y:A.y},D=A.height}return this.btt&&($.y+=D),$}})(),this.dragOvering=!0;const m=C.getSiblings(C.dragNode),_=m.indexOf(Z);je={tree:C,dragNode:Z,parent:Z.parent,siblings:m,indexBeforeDrop:_},b=this,(p=o.dataTransfer)==null||p.setData("text",`he-tree drag start at ${new Date().toISOString()}`),C._eachDroppable()||setTimeout(()=>{Z.hidden=!0,t(Z.parent,_+1)},0),(f=this.ondragstart)==null||f.call(this,o)},onEnter:o=>{this.$emit("enter",o)},onLeave:o=>{he=null,this.dragOvering=!1,ie.preventDefault=!1,n(),this.$emit("leave",o)},onDragOver:Lr(o=>{if(!C){if(!this.onExternalDragOver||this.onExternalDragOver(o)===!1)return;ie.preventDefault=!0}if(this.dragOverThrottleInterval>0)if(this._lastValidDragOver==null)this._lastValidDragOver=new Date().getTime();else{let w=new Date().getTime();if(w-this._lastValidDragOver>this.dragOverThrottleInterval)this._lastValidDragOver=w;else return}const d={x:o.clientX,y:o.clientY},p=e(d,s);if(s=d,!p)return;this.dragOvering=!0,b=this;const f=Oe?{x:Oe.x+(d.x-Xe.x),y:Oe.y+(d.y-Xe.y)}:{...d},{btt:m,rtl:_}=b;if(b.disableDrop){ie.dropEffect="none";return}let $,D;const A=b.getRootEl().querySelectorAll(".tree-node"),V=[];A.forEach(w=>{!rt(w,["drag-placeholder-wrapper","dragging-node"])&&Re(w,"display")!=="none"&&V.push(w)});const M=Ze(V,w=>Me(w)[m?"bottom":"top"]-f.y,{returnNearestIfNoHit:!0});let y=null,S,E;M.hit||(M.greater?m||(y=M.index-1,V[y]||y++):m&&(y=M.index+1,V[y]||y--)),y==null&&(y=M.index),S=V[y],E=m?V[y-1]:V[y+1],$=S&&b.getNodeByElement(S),D=E&&b.getNodeByElement(E);const{indent:x}=b,O=ke(()=>{if(b.table){let w=Me(S).toJSON();const K=x*($.level-1);return _?(w.width-=K,w.right-=K):w.x+=K,w}else return Me(S.firstElementChild)}).action,F=ke(()=>m?f.y>O().y+O().height/2:f.y<O().y+O().height/2).action,j=ke(()=>m?!S||y===V.length-1&&F():!S||y===0&&F()).action,ue=ke(()=>_?f.x-(O().x+O().width):O().x-f.x).action,g=ke(()=>_?f.x<O().x+O().width-x:f.x>O().x+x).action;let v;if(j())v=1,$=null;else if($)ue()>0?v=$.level-Math.ceil(ue()/x):g()?v=$.level+1:v=$.level;else return;D&&v<D.level&&(v=D.level),(async()=>{let w,K,q=!1,X=null;const le=async L=>{if(L.open)return!0;if(b.dragOpen)if(b.dragOpenDelay)if(X=L,he===L)q=!0;else{let N=Nr();he=L;const Y=L;return setTimeout(async()=>{Y!==he?(q=!0,N.resolve(!0)):(b.beforeDragOpen&&await b.beforeDragOpen(L),Y!==he?(q=!0,N.resolve(!0)):(L.open=!0,X=null,N.resolve(!0)))},b.dragOpenDelay),await N.promise}else return b.beforeDragOpen&&await b.beforeDragOpen(L),L.open=!0,!0;else return!1},ye=async()=>{if(b.isDroppable($)&&await le($)){if(q)return;w=$,K=null}else return!1},Ce=(L=v)=>{let N=$,Y=[];for(;N&&N.level>=L;)N=N.parent||null,Y.unshift(N);let oe=0;for(const fe of Y){if(b.isDroppable(fe))return w=fe,K=Y[oe+1]||$,!0;oe++}return!1};it=$||null,$?v>$.level?await ye()===!1&&Ce($.level):Ce()===!1&&await ye():b.isDroppable(null)&&(w=null),he=X;const De=!!(!q&&(w||w===null));return{cancelled:q,success:De,parent:w,index:De?K?(w?w.children:b.stats).filter(L=>L.data!==b.placeholderData).indexOf(K)+1:0:-1}})().then(w=>{if(!w.cancelled){if(!w.success){i(!1);return}if(b.maxLevel!=null&&b.maxLevel>0){let K=1;if(C){const q=C.dragNode;let X=0;te(q,le=>{le.level>X&&(X=le.level)},{childrenKey:ge}),K=X-q.level+1}if(K+(w.parent?w.parent.level:0)>b.maxLevel){i(!1);return}}i(!0),t(w.parent,w.index)}})}),onDrop:o=>{b=this;const d=!C;if(!b)return;const p=C?.dragNode;let f,m=(()=>{var _;let $=!0;if(!b.has(b.placeholderData))$=!1;else if(d)f=(_=this.externalDataHandler)==null?void 0:_.call(this,o),$=f!=null;else if(!C.dragCopy){const D=b.getStat(b.placeholderData);C===b&&D.parent===p.parent&&Ar(p,A=>A===D)}return $})();if(m){const _=b.getStat(b.placeholderData),$=b.getSiblings(_);xe={tree:b,dragNode:p,parent:_.parent,siblings:$,indexBeforeDrop:$.indexOf(_)}}(()=>{if(c(),m){let _=xe.indexBeforeDrop;C&&!C.dragCopy&&C===b&&je.parent==xe.parent&&je.indexBeforeDrop<_&&_--,C&&C!==b&&!C._eachDroppable()&&C.batchUpdate(()=>{C.remove(p),C.updateCheck()}),b.batchUpdate(()=>{let $=C?.dragNode,D;f?D=f:C._eachDroppable()&&(D=gt(C.dragNode.data,{childrenKey:C.childrenKey}),C.dragCopyDataHandler&&(D=C.dragCopyDataHandler(D))),D&&(b.add(D),$=b.getStat(D)),b.move($,xe.parent,_),b.updateCheck()})}b.$emit("after-drop"),m&&(C&&(C.dragCopy||C.$emit("change")),b!==C&&b.$emit("change"))})()},onDragEnd:o=>{c(),C&&(C.dragNode&&(C.dragNode.hidden=!1),C.dragNode=null,C.dragOvering=!1,C=null),b=null,he=null,Z=null,it=null}})},unmounted(){var e;(e=this.treeDraggableInstance)==null||e.destroy()}}),pa=we({props:{open:{type:Boolean}}}),fa=h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},[h("title",null,"chevron-right"),h("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})],-1),ha=[fa];function ga(e,t,n,r,i,s){return k(),T("a",{class:pe(["he-tree__open-icon",{open:e.open}])},ha,2)}const ma=Je(pa,[["render",ga]]),va={class:"ms-2 tree-pannel"},ya=["onDragover"],_a=["onClick"],ba=["onContextmenu","onClick"],wa={key:0,class:"icon-small fa-link fas mx-1"},ka={key:1,class:"icon-small fas fa-eye mx-1"},$a={__name:"TreeArticle",setup(e){const t=de();W(()=>t.article.id,()=>{o(t.article.id)}),W(()=>t.article,()=>{t?.article?.title&&typeof r?.text!=null&&(r.text=t?.article?.title,r.menuOn=t?.article?.menuOn,r.isRoute=t?.article?.isRoute,document.title=t.article.title)},{deep:!0}),Te(()=>{o(t.article.id)});function n(y,S){S(y),y?.children&&y.children.forEach(E=>{n(E,S)})}let r=null;const i=P(t.article.id);W(i,()=>{t.loadRec(i.value)});const s=P(0),a=P([]),l=P(),c=P([]);async function o(y){const S=await apiArt({command:"makeHeTree",id:y});i.value=y,a.value=S,n(a.value[0],E=>{E.lazy=!!(E?.directory&&!E?.children),E?.id===y&&(r=E)})}async function d(y,S,E){try{const x=await apiArt({command:"createNew",id:y.id}),O={id:x.id,text:x.title,parentId:x.parentId,directory:!1,npp:y.npp,children:[]},F=S;E.add(O,F,S.children.length),F.open=!0,i.value=x.id,document.showToast("Создано")}catch{return}}async function p(y,S,E){if(y.id==1){document.showToast("Не стоит удалять root");return}if(!await document.confirmDialog("Удалить ?"+y.id))return;const x=S.parent;x||document.showToast("Ошибка удаления parent не найден","error");let O;try{O=await apiArt({command:"deleteById",id:y.id})}catch{return}if(!E.remove(S)){document.showToast("Ошибка удаления элемента, перезагрузите","error");return}i.value=x.data.id??null,x.open=!0,x.data.directory=O.directory,x.data.text=O.title,E.openNodeAndParents(x),document.showToast("Удалено")}function f(y,S,E,x){c.value=[{label:"Новой вкладке",icon:"fas fa-link",command:()=>{window.open(location.pathname+"#"+S.id,"_blank")}},{label:"Создать",icon:"fas fa-plus",command:()=>d(S,E,x)},{label:"Удалить",icon:"fas fa-trash",command:()=>p(S,E,x)},{label:"Копировать",icon:"fas fa-copy",command:()=>m(S,E,x)}],l.value.show(y)}async function m(y,S,E){try{const x=await apiArt({command:"copyRec",id:y.id}),O={id:x.id,text:x.title,parentId:y.id,directory:!1,npp:y.npp,children:[]},F=S.parent;E.add(O,F,y.npp),F.open=!0,i.value=x.id,document.showToast("Скопировано")}catch{return}}function _(y,S){i.value=y.id}async function $(y,S,E){if(y.lazy&&!S?.data?.lazyLoad){S.data.lazyLoad=!0;let x;try{y._loading=!0,x=await apiArt({command:"getChildrens",id:y.id}),lazyLoad=!1}catch{}finally{y._loading=!1,S.data.lazy=!1}E.batchUpdate(()=>{E.addMulti(x,S,S.children.length),S.open=!0})}else S.open=!S.open}let D=null;function A(){const{dragNode:y}=Ye,S=y.parent??null,E=S?S.children.indexOf(y):0;D={parent:S,index:E},i.value=y.data.id}async function V(){const{dragNode:y,targetInfo:S}=Ye,E=y.data.id;if(E===1){M(y);return}const x=S?.parent??null,O=x?.data?.id??null;if(!O){M(y);return}const F=S.siblings??x.children??[],j=F.findIndex(g=>g===y||g.data?.id===E),ue=j>0?F[j-1].data?.id??0:0;try{const g=await apiArt({command:"move",id:E,newParentId:O,idBrotherUp:ue});x&&(x.open=!0)}catch{M(y);return}}function M(y){const{targetTree:S}=Ye;D?.parent&&S&&(S.move(y,D.parent,D.index),D.parent.open=!0)}return(y,S)=>{const E=se("ContextMenu");return k(),T("div",va,[(k(),ce(u(ua),{class:"mtl-tree my-2",modelValue:a.value,"onUpdate:modelValue":S[0]||(S[0]=x=>a.value=x),key:s.value,onAfterDrop:V,ondragstart:A,treeLine:""},{default:z(({node:x,stat:O,tree:F})=>[h("div",{class:"d-flex pointer",onDragover:Ge(j=>x.lazy?$(x,O,F):"",["stop","prevent"])},[h("div",null,[O.children.length?(k(),ce(u(ma),{key:0,open:O.open,class:"m-0 p-0",onClick:j=>O.open=!O.open},null,8,["open","onClick"])):U("",!0)]),x.lazy?(k(),T("div",{key:0,onClick:j=>$(x,O,F)},[...S[1]||(S[1]=[h("i",{class:"fas fa-chevron-right me-1"},null,-1)])],8,_a)):U("",!0),h("div",{onContextmenu:Ge(j=>f(j,x,O,F),["prevent"]),class:pe({active:x.id==i.value,notroute:!x.isRoute,route:x.isRoute}),onClick:j=>_(x,O)},[h("span",{style:ee(x.directory?"margin-left:-3px":"margin-left:3px")},null,4),Ke(R(x.text)+" ",1),x.isRoute?(k(),T("i",wa)):U("",!0),x.menuOn?(k(),T("i",ka)):U("",!0)],42,ba)],40,ya)]),_:1},8,["modelValue"])),B(E,{ref_key:"menu",ref:l,model:c.value},null,8,["model"])])}}},xa={class:"ms-2 tree-pannel"},Sa={class:"row my-1"},Ta={class:"input-group input-group-sm"},Ca=["textContent","onClick"],Da={__name:"FindText",setup(e){const t=de(),n=P([]),r=P("");async function i(){n.value=await t.search(r.value)}async function s(a){await t.loadRec(a),t.article.body.search(r.value)>=0&&(t.searchTextView=r.value),t.article.controller.search(r.value)>=0&&(t.searchTextController=r.value)}return(a,l)=>(k(),T("div",xa,[h("div",Sa,[h("div",Ta,[h("button",{class:"btn btn-primary fas fa-times",onClick:l[0]||(l[0]=c=>u(t).statusLeftPannel="tree")}),Q(h("input",{placeholder:"найти",type:"text",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=c=>r.value=c)},null,512),[[be,r.value]]),h("button",{class:"btn btn-primary fas fa-angle-right",onClick:l[2]||(l[2]=c=>i())})])]),(k(!0),T(ae,null,me(n.value,c=>(k(),T("div",null,[h("span",{textContent:R(c.title),onClick:o=>s(c.id),class:pe(["pointer",{active:u(t).article.id==c.id}])},null,10,Ca)]))),256))]))}},Ea=Ht(Da,[["__scopeId","data-v-f8b286bb"]]),Pa={key:0},Oa={style:{position:"relative"}},Aa={__name:"EditArticle",setup(e){const t=de(),n=P({show:!1,x:0,y:0});function r(){t.article.routeParams.useController||(p.value=0,m.value="view"),t.article.routeParams.useController&&(p.value=50,m.value="full"),t.modeEditorSplitter=m.value,d.value.resetState()}const i=P(null),s=P(20);let a=0;const l=P("open"),c=D=>{s.value=D.sizes[0]};function o(){l.value=="open"?(a=s.value,s.value=0,l.value="hidden"):(s.value=a,l.value="open"),t.modeTreeSplitter=l.value,i.value.resetState()}const d=P(),p=P(50);let f=0;const m=P("full");W(d,()=>{r()});function _(D){p.value=D.sizes[0]}function $(){switch(m.value){case"full":f=p.value,p.value=0,m.value="view";break;case"view":p.value=100,m.value="controller";break;case"controller":p.value=f,m.value="full";break}t.modeEditorSplitter=m.value,d.value.resetState()}return Te(()=>{const D=document.getElementById("editor-layer").getBoundingClientRect();n.value.y=window.innerHeight-D.top,n.value.x=window.innerWidth,n.value.show=!0,t.toggleTreeSplitter=o,t.toggleEditorSplitter=$,W(()=>t.article.routeParams.useController,()=>{r()})}),(D,A)=>{const V=se("SplitterPanel"),M=se("Splitter");return k(),T("div",null,[h("div",{style:ee({height:n.value.y+"px",width:n.value.x+"px"}),id:"editor-layer"},[n.value.show?(k(),T("div",Pa,[B(M,{style:ee({height:n.value.y+"px",width:n.value.x+"px"}),onResizeend:c,ref_key:"splitterTreeRef",ref:i},{default:z(()=>[B(V,{size:s.value,minSize:0},{default:z(()=>[h("div",Oa,[Q(h("button",{style:{position:"absolute",right:"10px","z-index":"1000"},class:"btn btn-primary fas fa-search",onClick:A[0]||(A[0]=y=>u(t).statusLeftPannel="find")},null,512),[[Ae,u(t).statusLeftPannel==="tree"]])]),Q(B($a,null,null,512),[[Ae,u(t).statusLeftPannel==="tree"]]),Q(B(Ea,null,null,512),[[Ae,u(t).statusLeftPannel==="find"]])]),_:1},8,["size"]),B(V,{size:100-s.value,minSize:1},{default:z(()=>[B(M,{style:{height:"100%"},onResizeend:_,ref_key:"splitEditorRef",ref:d},{default:z(()=>[B(V,{size:p.value,minSize:1},{default:z(()=>[B(Qe,{modelValue:u(t).article.controller,"onUpdate:modelValue":A[1]||(A[1]=y=>u(t).article.controller=y),lang:"php",theme:u(t).aceTheme,height:n.value.y},null,8,["modelValue","theme","height"])]),_:1},8,["size"]),B(V,{size:100-p.value,minSize:1},{default:z(()=>[B(Qe,{modelValue:u(t).article.body,"onUpdate:modelValue":A[2]||(A[2]=y=>u(t).article.body=y),lang:"html",theme:u(t).aceTheme,height:n.value.y},null,8,["modelValue","theme","height"])]),_:1},8,["size"])]),_:1},512)]),_:1},8,["size"])]),_:1},8,["style"])])):U("",!0)],4)])}}},La={class:""},Na={class:""},Ra={class:"my-2"},Va={__name:"Autocomplete",setup(e){const t=de(),{t:n}=Fe();return(r,i)=>{const s=se("Drawer");return k(),ce(s,{visible:u(t).statusAutocompletePannel,"onUpdate:visible":i[2]||(i[2]=a=>u(t).statusAutocompletePannel=a),header:u(n)("autocomplete_controller"),position:"bottom",style:{width:"700px",height:"50%"}},{default:z(()=>[h("div",La,[h("div",Na,[h("button",{class:"btn btn-success btn-sm",onClick:i[0]||(i[0]=a=>u(t).getController())},R(u(n)("autocomplete_simple_controller")),1)]),h("div",Ra,[h("button",{class:"btn btn-success btn-sm",onClick:i[1]||(i[1]=a=>u(t).getLiveWareController())},R(u(n)("autocomplete_liveWare_controller")),1)])])]),_:1},8,["visible","header"])}}},Ba={__name:"ArtEditor",setup(e){const t=de(),n=P(1);Te(()=>{const i=new URLSearchParams(window.location.search);Object.fromEntries(i.entries()),t.loadRec(Number(location.hash.slice(1))||1),history.pushState(n.value,null,"#"+n.value),console.log("--start ediror--"),$t("#ff642f"),window.addEventListener("popstate",r)}),xt(()=>{window.removeEventListener("popstate",r)});const r=i=>{n.value=Number(location.hash.slice(1))||1};return(i,s)=>(k(),T(ae,null,[u(t).articleReady?(k(),ce(mn,{key:0})):U("",!0),u(t).articleReady?(k(),ce(Aa,{key:1})):U("",!0),B(zt,{visible:u(t).statusFileManager,"onUpdate:visible":s[0]||(s[0]=a=>u(t).statusFileManager=a)},null,8,["visible"]),B(gr),u(t).articleReady?(k(),ce(cr,{key:2})):U("",!0),B(St),B(Va)],64))}},Fa=[ct,Ct,Dt,Et,Pt,Ot,At,Lt,Nt,Ut],ve=Tt(Ba);Fa.forEach(e=>{ve.component(e.name,e)});ve.use(Rt,{theme:{preset:Vt,options:{cssLayer:{name:"primevue",order:"theme, base, primevue"}}}});ve.use(Bt);ve.use(ct);ve.use(It());ve.use(Ft);ve.mount("#art_editor");Object.assign(globalThis,Kt);
